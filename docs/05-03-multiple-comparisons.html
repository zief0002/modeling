<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Multiple Comparisons – Statistical Modeling and Computation for Educational Scientists</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-732fb9ccd080a018ca85ca5d15770f52.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-21f15c15219cae8171071bd1662d9885.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/sticky-notes.css">
<link rel="stylesheet" href="assets/table-styles.css">
</head>

<body class="nav-sidebar floating fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-00-categorical-predictors.html">Categorical Predictors</a></li><li class="breadcrumb-item"><a href="./05-03-multiple-comparisons.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Multiple Comparisons</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Modeling and Computation for Educational Scientists</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Front Matter</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01-00-statistical-computation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Statistical Computation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-01-r-and-rstudio-installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R and RStudio: Installation and Setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-02-getting-started-with-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-03-data-structures-in-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Structures in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-04-data-wrangling-with-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Wrangling with dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-05-visualizing-with-ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualizing Data with ggplot2</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-00-intro-to-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-01-data-exploration-for-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Exploration for Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-02-simple-regression-and-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Simple Linear Regression and Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-03-ols-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ordinary Least Squares (OLS) Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-04-anova-decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">ANOVA Decomposition and <span class="math inline">\(R^2\)</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-05-standardized-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Standardized Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03-00-regression-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-01-coefficient-level-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Coefficient-Level Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-02-model-level-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model-Level Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-03-model-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Assumptions Underlying the Regression Model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04-00-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-01-intro-to-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduction to Multiple Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-02-multiple-regression-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multiple Regression: ANOVA Decomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-03-understanding-statistical-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Understanding Statistical Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-04-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Assumptions: Multiple Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./05-00-categorical-predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Categorical Predictors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-01-dichotomous-predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Dichotomous Categorical Predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-02-polychotomous-predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Polychotomous Categorical Predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-03-multiple-comparisons.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Multiple Comparisons</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./06-00-interaction-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interaction Effects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-01-intro-to-interaction-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction to Interaction Effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-02-more-interaction-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">More Interaction Effects</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Codebooks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/broadband.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">broadband.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/comic-characters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">comic-characters.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/evaluations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">evaluations.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/fertility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">fertility.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/gapminder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gapminder.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/keith-gpa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">keith-gpa.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/mn-schools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">mn-schools.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/pew.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pew.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/riverview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">riverview.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/scoobydoo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">scoobydoo.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/spice-girls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">spice-girls.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/state-education.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">state-education.csv</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./codebooks/work-demands.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">work-demands.csv</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-00-categorical-predictors.html">Categorical Predictors</a></li><li class="breadcrumb-item"><a href="./05-03-multiple-comparisons.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Multiple Comparisons</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="mult-comp" class="quarto-section-identifier"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Multiple Comparisons</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter, you will learn about why it is important to adjust <em>p</em>-values and confidence intervals when we are comparing more than two groups. You will also learn about familywise error rates and false discovery rates. Finally, you will learn about methods to deal with multiple comparisons. To do so, we will again use the <strong>pew.csv</strong> data to examine whether American’s news knowledge differs based on the source of their news.</p>
<p>To begin, we will load several libraries and import the data into an object called <code>pew</code>. We will also fit one of our regression models that allowed us to examine differences in knowledge based on news source, after controlling for differences in age, education level, amount of news consumed, and political engagement.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data and create dummy variables</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>pew <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/modeling/main/data/pew.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">none    =</span> <span class="fu">if_else</span>(news_source <span class="sc">==</span> <span class="st">"None"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">con     =</span> <span class="fu">if_else</span>(news_source <span class="sc">==</span> <span class="st">"Conservative"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">com     =</span> <span class="fu">if_else</span>(news_source <span class="sc">==</span> <span class="st">"Comedy"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">lib     =</span> <span class="fu">if_else</span>(news_source <span class="sc">==</span> <span class="st">"Liberal"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>pew</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,094 × 13
      id knowledge news_source   news ideology engagement   age
   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1     1        50 Conservative    63     39.3       79.5  44.4
 2     3        45 None            49     75.7       61    45.7
 3     4        26 None            22     23.5       66.8  39.3
 4     5        79 None            54     69.5       80.8  59.5
 5     6        31 Conservative    65     18         99.6  43.8
 6     7        22 Conservative    63     33.2       37.4  29.6
 7     8        93 Conservative    50     29.7       88.6  29.6
 8     9        23 None            12     52.5       82.4  45.1
 9    10        41 Liberal         16     14         87.3  18.7
10    11        23 Liberal         43     62         67    47.5
# ℹ 1,084 more rows
# ℹ 6 more variables: education &lt;dbl&gt;, female &lt;chr&gt;, none &lt;dbl&gt;,
#   con &lt;dbl&gt;, com &lt;dbl&gt;, lib &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model (None is reference group)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>lm.none<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lm</span>(knowledge <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> education <span class="sc">+</span> news <span class="sc">+</span> engagement <span class="sc">+</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                 com <span class="sc">+</span> con <span class="sc">+</span> lib, <span class="at">data =</span> pew)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<section id="alpha-level-and-errors" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="alpha-level-and-errors"><span class="header-section-number">20.1</span> <span class="math inline">\(\alpha\)</span>-Level and Errors</h2>
<p>Recall that when we evaluated the difference between each pair of news sources, we did so by comparing the <em>p</em>-value to our <span class="math inline">\(\alpha\)</span>-level of 0.05. Remember also that the alpha-value is determined by the researcher and determines the Type I error rate for the study, where a Type I error is the probability of rejecting the null hypothesis if it is really true. In our study, this would mean we claim there is a difference in news knowledge between two news sources, but there really isn’t.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Remembering Type I and II errors…simplified by Flowing Data.</figcaption>
<p><img src="figs/20-01-errors.png" class="img-fluid figure-img" style="width:100.0%" alt="Remembering Type I and II errors...simplified by Flowing Data."></p>
</figure>
</div>
</div>
</div>
<p>One way to think about a Type I error is that it represents a <em>false discovery</em>. The data have mislead the researcher into saying there is an effect when in fact there isn’t. When we use an <span class="math inline">\(alpha\)</span>-level of 0.05, we are saying that we are OK making a false discovery in 5% of the hypothesis tests we will ever evaluate.</p>
<p>Imagine a researcher who evaluates 1000 hypothesis tests during their career. Let’s imagine also that this researcher always does a sample size analysis prior to every research project and always has a large enough sample size to have statistical power of 0.8, a commonly used value in the social and educational sciences. (That is they would be able to detect a true effect 80% of the time that there actually is an effect.) Lastly, let’s assume that half of all the hypothesis that this research evaluates are in reality true<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. If this researcher always used an <span class="math inline">\(alpha\)</span>-value of 0.05, then:</p>
<ul>
<li>Of the 1000 tests, they would be able to detect 400 true effects which could be written about in manuscripts.</li>
<li>Of the 1000 tests, they would make 50 false discoveries—that is they would publish about a false claim 50 times in their career.</li>
</ul>
<p>Think of how many hypothesis tests you will carry out in your career, it will likely be more than 1000, and 5% of those will be false discoveries! This is alarming, but is expected when we use an <span class="math inline">\(alpha\)</span>-value of 0.05. What is more alarming is that if you only consider the 450 “publishable” hypotheses (i.e., those for which you found an effect, including the false discoveries), the false positive rate is about 11%. This is much higher than the advertised 5% rate.</p>
<p><br></p>
<section id="multiple-tests-on-the-same-data" class="level3" data-number="20.1.1">
<h3 data-number="20.1.1" class="anchored" data-anchor-id="multiple-tests-on-the-same-data"><span class="header-section-number">20.1.1</span> Multiple Tests on the Same Data</h3>
<p>When a researcher carries out multiple hypothesis tests on the same data, it turns out that the probability of making false discoveries gets higher than value we set for <span class="math inline">\(\alpha\)</span>. This is especially problematic when researchers are coming at the data without any <em>a priori</em> hypotheses to be tested, which are generally based on relationships identified in the theoretical literature. Statisticians refer to this as taking an <em>Exploratory Approach</em> with hypothesis testing.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Another way to think about the exploratory approach is that the researcher is “data dredging”—they are testing a lot of different effects to see what pops.</p>
<p>Another common situation in which the probability of making false discoveries gets higher than value we set for <span class="math inline">\(\alpha\)</span> is when researchers have multiple groups that they are testing differences between. This is exactly the situation we have in our news knowledge study! In our study we had eight different groups that we were evaluating differences between. <strong>Having multiple groups that you are comparing leads to higher than specified rates of false discovery regardless of whether the approach is exploratory or confirmatory.</strong></p>
<p><span class="citation" data-cites="Whalley:2018">Whalley (<a href="#ref-Whalley:2018" role="doc-biblioref">2018</a>)</span> offers a nice metaphor about buying lottery tickets to help you understand why testing differences between multiple groups increases the number of false discoveries. He writes, “if you buy more tickets you have a larger change of winning a prize. [For example], with three comparisons between the groups (tickets) we have a 15% chance of winning a prize, rather than the 5% we intended.” That is, mathematically, we can think about the false positive rate as a function of the number of hypothesis tests you conduct. Specifically,</p>
<p><span class="math display">\[
\mathrm{False~Positive~Rate} = (\mathrm{Number~of~Tests~Evaluated}) \times 0.05
\]</span></p>
<p>If you were only doing one test, the false positive rate would be 0.05, our designated <span class="math inline">\(\alpha\)</span>-value. For three tests, the false positive rate would be <span class="math inline">\(3\times.05=.15\)</span>, much higher than the designated <span class="math inline">\(\alpha\)</span>-value. For our news knowledge example, we carried out 6 tests. The false positive rate in our study is <span class="math inline">\(6\times.05=.30\)</span>!</p>
<p><br></p>
</section>
</section>
<section id="fixing-the-problem" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="fixing-the-problem"><span class="header-section-number">20.2</span> Fixing the Problem</h2>
<p>There are two approaches to fixing this problem: (1) controlling for the familywise error rate, and (2) controlling for the false discovery rate. Both of these methods, in practice, involve penalizing the size of the <em>p</em>-value (making it bigger) based on the number of tests you are evaluating. We refer to this as “adjusting the <span class="math inline">\(p\)</span>-values”.</p>
<p><br></p>
<section id="controlling-the-family-wise-error-eate" class="level3" data-number="20.2.1">
<h3 data-number="20.2.1" class="anchored" data-anchor-id="controlling-the-family-wise-error-eate"><span class="header-section-number">20.2.1</span> Controlling the Family-Wise Error Eate</h3>
<p>The first approach for adjusting <span class="math inline">\(p\)</span>-values is to control for the familywise error rate. The familywise-error rate is defined as the probability of making AT LEAST ONE Type I Error in all of the hypothesis tests that you are evaluating. As an example consider a situation in which we were conducting hypothesis tests to evaluate pairwise differences in three groups, A, B, and C. We would be carrying out the following hypothesis tests:</p>
<ul>
<li>Hypothesis Test 1: A vs.&nbsp;B</li>
<li>Hypothesis Test 2: A vs.&nbsp;C</li>
<li>Hypothesis Test 3: B vs.&nbsp;C</li>
</ul>
<p>You could make a Type I error in HT 1, in HT 2, or in HT 3, respectively. You could also make a Type I error in HT 1 and HT 2, but not in HT 3. Or, you could make a Type I error in HT 1 and HT 3, but not in HT 2. Or, you could make a Type I error in HT 2 and HT 3, but not in HT 1. Or, you could make a Type I error in all three tests! In controlling for family-wise error, we would want the total error rate across all of those possibilities to be no more than our <span class="math inline">\(\alpha\)</span>-value (We would refer to this as the family-wise <span class="math inline">\(\alpha\)</span>-value or <span class="math inline">\(\alpha_{\mathrm{FW}}\)</span>). Mathematically,</p>
<p><span class="math display">\[
\begin{split}
\alpha_{\mathrm{FW}} = P\biggl(\mathrm{Type~I~error~in~}&amp;(\mathrm{HT1}) \lor (\mathrm{HT2}) \lor (\mathrm{HT3}) \lor \\
&amp;(\mathrm{HT1~and~HT2}) \lor (\mathrm{HT1~and~HT3}) \lor (\mathrm{HT2~and~HT3}) \lor \\
&amp;(\mathrm{HT1~and~HT2~and~HT3})\biggr)
\end{split}
\]</span></p>
<p>Most social and educational scientists who take this approach set their family-wise error rate to 0.05.</p>
<p><br></p>
<section id="dunn-bonferroni-adjustments" class="level4" data-number="20.2.1.1">
<h4 data-number="20.2.1.1" class="anchored" data-anchor-id="dunn-bonferroni-adjustments"><span class="header-section-number">20.2.1.1</span> Dunn-Bonferroni Adjustments</h4>
<p>An Italian mathematician named <a href="https://en.wikipedia.org/wiki/Carlo_Emilio_Bonferroni">Carlo Emilio Bonferroni</a> generalized a finding from probability theory (Boole’s inequality) to determine the upper bound on making a Type I error in <em>k</em> tests <span class="citation" data-cites="Dunn:1961">(<a href="#ref-Dunn:1961" role="doc-biblioref">Dunn, 1961</a>)</span>. (<em>k</em> here refers to the number of tests.) Statistician <a href="https://en.wikipedia.org/wiki/Olive_Jean_Dunn">Olive Jean Dunn</a> developed the mathematical details of using Bonferroni’s results and was the first to apply them to the problem of multiple comparisons. This inequality is:</p>
<p><span class="math display">\[
P(\mathrm{Type~I~error}) &lt; 1 - (1 - \alpha_{\mathrm{PC}})^k
\]</span></p>
<p>where <span class="math inline">\(\alpha_{\mathrm{PC}}\)</span> is the alpha level for each test (the per-comparison alpha value), and <em>k</em> is the number of tests (comparisons) for the effect. This is where the shortcut of multiplying the number of tests by the <span class="math inline">\(\alpha\)</span>-level comes from; it is an approximation for this inequality. That is,</p>
<p><span class="math display">\[
1 - (1 - \alpha_{\mathrm{PC}})^k \approx k \times \alpha_{\mathrm{PC}}
\]</span></p>
<p>That means, if we want our family-wise error rate to be 0.05, we can set this to be equal to 0.05 and solve for the <span class="math inline">\(\alpha_{\mathrm{PC}}\)</span> based on the number of tests be evaluated. In our news knowledge example, there are 28 different tests we are evaluating. So to determine the per-comparison alpha value, we would need to solve the following:</p>
<p><span class="math display">\[
\begin{split}
6 \times \alpha_{\mathrm{PC}} &amp;= 0.05 \\[2ex]
\alpha_{\mathrm{PC}} &amp;= \frac{0.05}{6} \\[2ex]
&amp;= 0.008
\end{split}
\]</span> That is, rather than comparing the <em>p</em>-value we got to 0.05, we should have been comparing the <em>p</em>-value to 0.008.</p>
<p>In practice, we don’t adjust the <span class="math inline">\(alpha\)</span>-value, but instead adjust the <em>p</em>-value. The easiest way to make these adjustments is to multiply each <em>p</em>-value for the group comparisons by the number of tests being evaluated. If we have <em>k</em> tests, then:</p>
<p><span class="math display">\[
p_{\mathrm{Adjusted}}=p_{\mathrm{Original}} \times k
\]</span></p>
<p>In our example,</p>
<p><span class="math display">\[
p_{\mathrm{Adjusted}}=p_{\mathrm{Original}} \times 6
\]</span></p>
<div class="fyi">
<p><strong>FYI</strong></p>
<p>This <em>p</em>-value adjustment is referred to as the Dunn-Bonferroni adjustment.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
</div>
<p>Consider the 6 <em>p</em>-values for our pairwise comparisons of news knowledge from the model that included covariates (from <code>lm.none.2</code>). To compute the Dunn-Bonferroni adjusted <em>p</em>-values for these comparisons, we could use the followwing syntax.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.01142</span>, <span class="co">#Comedy vs. Conservative                     </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.54808</span>, <span class="co">#Comedy vs. Liberal                          </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.00977</span>, <span class="co">#Comedy vs. None                             </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000582</span>, <span class="co">#Conservative vs. Liberal                    </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.955204</span>, <span class="co">#Conservative vs. None                       </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000385</span> <span class="co">#Liberal vs. None                            </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">*</span> <span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.068520 3.288480 0.058620 0.003492 5.731224 0.002310</code></pre>
</div>
</div>
<p>We can compare these adjusted <em>p</em>-values to 0.05 to evaluate whether groups differ in their average news knowledge. There are now only two comparisons that are statistically different than 0:</p>
<ul>
<li>Conservative vs.&nbsp;Liberal (<span class="math inline">\(p=.003\)</span>)</li>
<li>Liberal vs.&nbsp;None (<span class="math inline">\(p=.002\)</span>)</li>
</ul>
<p>Of the 6 comparisons, we found only 2 statistically discernible differences. Compare this to the 4 statistically discernible differences we found when we used the unadjusted <em>p</em>-values (in the previous chapter). This means that 2 of those previous findings were likely false discoveries!</p>
<div class="fyi">
<p>In practice, since <em>p</em>-values have limits of 0 and 1, any adjusted <em>p</em>-value that exceeds 1 we limit to 1 when we report them.</p>
</div>
<p><br></p>
</section>
<section id="obtaining-the-dunn-bonferroni-p-values-directly" class="level4" data-number="20.2.1.2">
<h4 data-number="20.2.1.2" class="anchored" data-anchor-id="obtaining-the-dunn-bonferroni-p-values-directly"><span class="header-section-number">20.2.1.2</span> Obtaining the Dunn-Bonferroni <em>p</em>-Values Directly</h4>
<p>In practice, you are not going to list all of the unadjusted <em>p</em>-values in a vector and multiply by <em>k</em>. Instead, we are going to use the <code>emmeans()</code> function from the <code>{emmeans}</code> package to obtain the Dunn-Bonferroni <em>p</em>-values. This argument takes three arguments:</p>
<ul>
<li>The name of a model object that has been fitted using a true categorical predictor in the <code>lm()</code> function (not with dummy variables).</li>
<li>The argument <code>specs=pairwise ~predictor</code> (where <code>predictor</code> is the name of the categorical predictor on which you want to do pairwise comparisons).</li>
<li>The argument <code>adjust=</code> which takes a character string that specifies the adjustment method to use.</li>
</ul>
<p>The first thing we need to do, is re-fit the model using the actual categorical predictor (<code>news_source</code>) rather than the dummy variables.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model using categorical predictor</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>lm.news_source <span class="ot">=</span> <span class="fu">lm</span>(knowledge <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> age <span class="sc">+</span> education <span class="sc">+</span> news <span class="sc">+</span> engagement <span class="sc">+</span> news_source, <span class="at">data =</span> pew)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When you use the categorical predictor (rather than the set of dummy variables), R will create the set of dummy variables for you. It will also choose the reference group for you. It does this alphabetically, so in our example, the reference group it will choose is “All”. You can see this by looking at the coefficient-level output of the fitted model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.news_source)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  term                    estimate std.error statistic  p.value
  &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)              -20.0      5.07      -3.93  8.91e- 5
2 age                        0.186    0.0322     5.77  1.02e- 8
3 education                  3.24     0.248     13.1   2.02e-36
4 news                       0.230    0.0301     7.64  4.78e-14
5 engagement                 0.233    0.0349     6.67  4.19e-11
6 news_sourceConservative   -7.79     3.07      -2.53  1.14e- 2
7 news_sourceLiberal        -1.91     3.18      -0.601 5.48e- 1
8 news_sourceNone           -7.87     3.04      -2.59  9.77e- 3</code></pre>
</div>
</div>
<p>Now, we can use that model in our <code>emmeans()</code> function. Since we are interested in the pairwise comparisons between the different news sources, the second argument in the function will be <code>specs = pairwise ~news_source</code>. Before we make any adjustments, let’s double-check that the function works by having it compute the unadjusted <em>p</em>-values for the differences. To get the unadjusted differences we will use <code>adjust="none"</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the unadjusted p-values for pairwise differences</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(lm.news_source, <span class="at">specs =</span> pairwise <span class="sc">~</span>news_source, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 news_source  emmean    SE   df lower.CL upper.CL
 Comedy         61.3 2.890 1086     55.6     67.0
 Conservative   53.5 1.050 1086     51.5     55.6
 Liberal        59.4 1.370 1086     56.7     62.1
 None           53.4 0.897 1086     51.7     55.2

Confidence level used: 0.95 

$contrasts
 contrast               estimate   SE   df t.ratio p.value
 Comedy - Conservative    7.7857 3.07 1086   2.534  0.0114
 Comedy - Liberal         1.9128 3.18 1086   0.601  0.5481
 Comedy - None            7.8682 3.04 1086   2.589  0.0098
 Conservative - Liberal  -5.8729 1.70 1086  -3.450  0.0006
 Conservative - None      0.0825 1.47 1086   0.056  0.9552
 Liberal - None           5.9554 1.67 1086   3.562  0.0004</code></pre>
</div>
</div>
<p>The output has two parts to it. In the first part (<code>$emmeans</code>) we are given the mean news knowledge for each news source. Because we used a model that included covariates, these are the covariate adjusted means. We are also provided the standard errors, and the confidence interval limits for those means. (We are also given the residual degrees-of-freedom used to create those intervals.) Note that these are the same confidence limits we used to create our plot of the CIs in the previous chapter!</p>
<p>In the second part of the output (<code>$contrasts</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>), we are given each of the pairwise differences, as well as the SEs, <em>t</em>-values, and <em>p</em>-values associated with those differences. These are the same values we get from the <code>lm()</code> output. The nice thing is we are given all of the pairwise differences in an organized manner without having to fitt many different <code>lm()</code> models using differnt reference groups.</p>
<p>To obtain the Dunn-Bonferroni adjusted <em>p</em>-values, we will update the argument <code>adjust=</code> to <code>adjust="bonferroni"</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the Dunn-Bonferroni adjusted p-values for pairwise differences</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(lm.news_source, <span class="at">specs =</span> pairwise <span class="sc">~</span>news_source, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 news_source  emmean    SE   df lower.CL upper.CL
 Comedy         61.3 2.890 1086     55.6     67.0
 Conservative   53.5 1.050 1086     51.5     55.6
 Liberal        59.4 1.370 1086     56.7     62.1
 None           53.4 0.897 1086     51.7     55.2

Confidence level used: 0.95 

$contrasts
 contrast               estimate   SE   df t.ratio p.value
 Comedy - Conservative    7.7857 3.07 1086   2.534  0.0685
 Comedy - Liberal         1.9128 3.18 1086   0.601  1.0000
 Comedy - None            7.8682 3.04 1086   2.589  0.0586
 Conservative - Liberal  -5.8729 1.70 1086  -3.450  0.0035
 Conservative - None      0.0825 1.47 1086   0.056  1.0000
 Liberal - None           5.9554 1.67 1086   3.562  0.0023

P value adjustment: bonferroni method for 6 tests </code></pre>
</div>
</div>
<p>In the <code>$contrasts</code> part of the output, the <em>p</em>-values shown are the Dunn-Bonferroni adjust <em>p</em>-values. . Note that the output in <code>$emmeans</code> section remains exactly the same as when we used <code>adjust="none"</code>. This is because the <code>$emmeans</code> section will always be the model predicted means from the fitted <code>lm()</code>.</p>
<p>We can display the results of the Dunn-Bonferroni pairwise differences in a table or visualization similar to those we created previously. <a href="#tbl-mult-comp-bonferroni" class="quarto-xref">Table&nbsp;<span>20.1</span></a> shows one such table Note that the adjusted mean values have been updated based on the values from the <code>$emmeans</code> part of the output. (These values should be more exact as we rounded extensively in the computations of these values.)</p>
<div id="tbl-mult-comp-bonferroni" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mult-comp-bonferroni-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20.1: Pairwise contrasts between the average news knowledge for different news sources after controlling for differences in age, education, news consumption, and political engagement. The p-values have been adjusted using the Dunn-Bonferroni method.
</figcaption>
<div aria-describedby="tbl-mult-comp-bonferroni-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="mnxumteijy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
  
  
<table class="gt_table cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false" width="75%" data-bgcolor="#FFFFFF">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead style="border-style: none;">
<tr class="gt_col_headings header" style="border-style: none; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3;">
<th id="contrast" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col" style="text-align: left; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom"><br>
Contrast</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col" style="text-align: center; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom">Mean<br>
Difference</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col" style="text-align: center; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom"><br>
<em>p</em></th>
</tr>
</thead>
<tbody class="gt_table_body" style="border-style: none; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3;">
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Comedy - Conservative</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">7.79</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.069</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Comedy - Liberal</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">1.91</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">1.000</td>
</tr>
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Comedy - None</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">7.87</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.059</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Conservative - Liberal</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">−5.87</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.003</td>
</tr>
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Conservative - None</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.08</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">1.000</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Liberal - None</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">5.96</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.002</td>
</tr>
</tbody>
</table>

</div>
</div>
</figure>
</div>
<div class="fyi">
<p>There are many other methods to control the familywise error rate. Some other popular methods include the Tukey adjustment <span class="citation" data-cites="Tukey:1949">(<a href="#ref-Tukey:1949" role="doc-biblioref">Tukey, 1949</a>)</span>, the Scheffé adjustment <span class="citation" data-cites="Scheffe:1959">(<a href="#ref-Scheffe:1959" role="doc-biblioref">Scheffé, 1959</a>)</span>, and the Holm adjustment <span class="citation" data-cites="Holm:1979">(<a href="#ref-Holm:1979" role="doc-biblioref">Holm, 1979</a>)</span>. Each method gives different <em>p</em>-values based on the mathematics of the adjustments, but they are all pretty similar. The Dunn-Bonferroni method is the most popular method used in the educational and social sciences to control the familywise error rate.</p>
</div>
<p><br></p>
</section>
</section>
<section id="controlling-the-false-discovery-rate" class="level3" data-number="20.2.2">
<h3 data-number="20.2.2" class="anchored" data-anchor-id="controlling-the-false-discovery-rate"><span class="header-section-number">20.2.2</span> Controlling the False Discovery Rate</h3>
<p>The second approach to adjusting <em>p</em>-values is to control for the false discovery rate. While controlling for the familywise error rate attends to controlling false discoveries, the disadvantage is that those methods increase the Type II error rate; that is they will increase the probability of incorrectly failing to reject the null hypothesis. This means that they will lead to neglecting to find differences that might be theoretically or clinically relevant. Controlling the false discovery rate rather than the familywise error rate attends to this by minimizing the number of false discoveries (Type I errors), while at the same time trying to avoid Type II errors.</p>
<p><br></p>
<section id="benjamini-hochberg-adjusments-to-the-p-values" class="level4" data-number="20.2.2.1">
<h4 data-number="20.2.2.1" class="anchored" data-anchor-id="benjamini-hochberg-adjusments-to-the-p-values"><span class="header-section-number">20.2.2.1</span> Benjamini-Hochberg Adjusments to the <em>p</em>-Values</h4>
<p>The primary method for controlling the false discovery rate used in the social and educational sciences is the Benjamin-Hochberg adjustment to the <em>p</em>-values. To obtain these, we can use the same <code>emmeans()</code> function with the argument <code>adjust="BH"</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the Benjamini-Hochberg adjusted p-values for pairwise differences</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(lm.news_source, <span class="at">specs =</span> pairwise <span class="sc">~</span>news_source, <span class="at">adjust =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 news_source  emmean    SE   df lower.CL upper.CL
 Comedy         61.3 2.890 1086     55.6     67.0
 Conservative   53.5 1.050 1086     51.5     55.6
 Liberal        59.4 1.370 1086     56.7     62.1
 None           53.4 0.897 1086     51.7     55.2

Confidence level used: 0.95 

$contrasts
 contrast               estimate   SE   df t.ratio p.value
 Comedy - Conservative    7.7857 3.07 1086   2.534  0.0171
 Comedy - Liberal         1.9128 3.18 1086   0.601  0.6577
 Comedy - None            7.8682 3.04 1086   2.589  0.0171
 Conservative - Liberal  -5.8729 1.70 1086  -3.450  0.0017
 Conservative - None      0.0825 1.47 1086   0.056  0.9552
 Liberal - None           5.9554 1.67 1086   3.562  0.0017

P value adjustment: BH method for 6 tests </code></pre>
</div>
</div>
<p>Using this <em>p</em>-value adjustment method, we find 4 statistically discernible differences. These are displayed in <a href="#tbl-mult-comp-bh" class="quarto-xref">Table&nbsp;<span>20.2</span></a>.</p>
<div id="tbl-mult-comp-bh" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mult-comp-bh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20.2: Pairwise contrasts between the average news knowledge for different news sources after controlling for differences in age, education, news consumption, and political engagement. The p-values have been adjusted using the Benjamini-Hochberg method.
</figcaption>
<div aria-describedby="tbl-mult-comp-bh-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="sraossznzb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
  
  
<table class="gt_table cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false" width="75%" data-bgcolor="#FFFFFF">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead style="border-style: none;">
<tr class="gt_col_headings header" style="border-style: none; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3;">
<th id="contrast" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col" style="text-align: left; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom"><br>
Contrast</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col" style="text-align: center; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom">Mean<br>
Difference</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col" style="text-align: center; border-style: none; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden;" data-bgcolor="#FFFFFF" data-valign="bottom"><br>
<em>p</em></th>
</tr>
</thead>
<tbody class="gt_table_body" style="border-style: none; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3;">
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Comedy - Conservative</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">7.79</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.017</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Comedy - Liberal</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">1.91</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.658</td>
</tr>
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Comedy - None</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">7.87</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.017</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Conservative - Liberal</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">−5.87</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.002</td>
</tr>
<tr class="odd" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Conservative - None</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.08</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.955</td>
</tr>
<tr class="even" style="border-style: none;">
<td class="gt_row gt_left" headers="contrast" style="text-align: left; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">Liberal - None</td>
<td class="gt_row gt_center" headers="estimate" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">5.96</td>
<td class="gt_row gt_center" headers="p.value" style="text-align: center; border-style: none; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;" data-valign="middle">0.002</td>
</tr>
</tbody>
</table>

</div>
</div>
</figure>
</div>
<p>If we compare the three sets of <em>p</em>-values (unadjusted, Dunn-Bonferroni, and Benjamini-Hochberg), there are some things you can see:</p>
<ul>
<li>The unadjusted <em>p</em>-values are the smallest. While you are more likely to “find” effects, some (or most) of these may be false discoveries.</li>
<li>The Dunn-Bonferroni adjusted <em>p</em>-values are the largest. Controlling for familywise error rates really protects against making Type I error. To do this it heavily penalizes the <em>p</em>-values (makes them larger).</li>
<li>The Benjamini-Hochberg adjusted <em>p</em>-values are somewhere between the unadjusted and Dunn-Bonferroni <em>p</em>-values. While this helps protect against false discoveries (they are larger than the unadjusted <em>p</em>-values so you are less likely to find effects), it does so with a less heavy penalty than the Dunn-Bonferroni penalty. This protects against Type II errors.</li>
</ul>
<div class="fyi">
<p>In the Dunn-Bonferroni method, each of the 6 <em>p</em>-values was penalized by the exact same amount; each of the unadjusted <em>p</em>-values was multiplied by 6. The way that the Benjamini-Hochberg method protects against Type II errors is that it penalizes the <em>p</em>-values differentially. While the exact methodology is beyond the scope of the course, if you are interested you can read the original paper in which the method was described <span class="citation" data-cites="Benjamini:1995">(<a href="#ref-Benjamini:1995" role="doc-biblioref">Benjamini &amp; Hochberg, 1995</a>)</span>.</p>
</div>
<p><br></p>
</section>
</section>
</section>
<section id="which-adjustment-method-should-you-use" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="which-adjustment-method-should-you-use"><span class="header-section-number">20.3</span> Which Adjustment Method Should You Use?</h2>
<p>There is no right answer to this question. Controlling for the familywise error rate or for the false discovery rate needs to be decided by the reseracher. There are good reasons to choose either. In general if you want to really protect against Type I errors, you would control the familywise error rate. This usually occurs when the researcher has adopted a confirmatory approach to the data analysis. On the other hand, if you worry about false discovery, but not at the expense of not discovering ‘true’ effects, then controlling for the false discovery rate is more appropriate. This is a better fit when the researcher is undertaking an exploratory approach to the data analysis. You should also note that some fields (e.g., neuroscience) have particular proclivities for how to adjust <em>p</em>-values for multiple comparisons.</p>
<p>Regardless of the approach, you should decide which adjustment method you will use <strong>before you do the analysis</strong>. In the educational and social sciences, the Dunn–Bonferroni method has been historically the most popular method (probably because it was easy to implement before computing), although historical popularity is probably not the best manner of choosing a methodology.</p>
<p>If you are unsure about which procedure to use, for many analyses the Benjamini-Hochberg adjustment method is a good choice. There is a growing pool of research evidence that suggests controlling FDR may be the “best” solution to the problem of multiple comparisons <span class="citation" data-cites="Williams:1999">(<a href="#ref-Williams:1999" role="doc-biblioref">Williams et al., 1999</a>)</span>. Moreover, the Institute of Education Sciences has recommended the Benjamini-Hochberg adjustment method in its <a href="https://ies.ed.gov/ncee/wwc/Handbooks">Procedures Handbook</a> <span class="citation" data-cites="What-Works-Clearinghouse:2020">(<a href="#ref-What-Works-Clearinghouse:2020" role="doc-biblioref">What Works Clearinghouse, 2020</a>)</span>.</p>
<p><br></p>
<!-- ## Plot of Confidence Intervals for Adjusted Means Based on Adjusted *p*-Values -->
<!-- Similar to the plot we created in the previous chapter, we can produce a plot of the confidence intervals for the adjusted means and then plot those for each group. One caveat is that these intervals should correspond to the adjustments we have done to the *p*-values so that readers inferences about which groups differ are consistent with what we report using the *p*-value adjustment methods. In general, this means that the CIs produced for each of the adjusted means will be wider (more uncertainty) than the original CIs. -->
<!-- One issue we have is that in the output from the `emmeans()` function, the CIs for the adjusted means are in the `$emmeans` part of the output, and this does not change when we use differnt adjustment methods---that is, we are always getting the unadjusted CIs. If we have used the Dunn-Bonferroni method to adjust *p*-values, there is an easy solution to this, namely changing the confidence level. It turns out that the Bonferroni-adjusted CIs are just CIs that have the confidence level of: -->
<!-- $$ -->
<!-- \mathrm{Confidence~Level} = 1 - \frac{\alpha_{\mathrm{FW}}}{k} -->
<!-- $$ -->
<!-- where $\alpha_{\mathrm{FW}}$ is the familywise error rate (usually 0.05), and *k* is the number of comparisons being evaluated. In our example $k=28$, and the confidence level would be: -->
<!-- $$ -->
<!-- \begin{split} -->
<!-- \mathrm{Confidence~Level} &= 1 - \frac{0.05}{28} \\[2ex] -->
<!-- &=0.9982143 -->
<!-- \end{split} -->
<!-- $$ -->
<!-- To obtain the Dunn-Bonferroni adjusted CIs we will use the `confint()` function. We start by assigning our `emmeans()` results into an object, and then calling the `confint()` function on this object. To change the confidence level we use the argument `level=`. The syntax below will compute the Dunn-Bonferroni adjusted CIs for the adjusted mean news knowledge for each of the different news sources. -->
<!-- ```{r} -->
<!-- # Assign emmeans() output to an object -->
<!-- bonf = emmeans(lm.news_source, specs = pairwise ~news_source, adjust = "bonferroni") -->
<!-- # Get Dunn-Bonferroni adjusted CIs -->
<!-- confint(bonf, level = 0.9982143) -->
<!-- ``` -->
<!-- The information we need to create the plot is contained in the `$emmeans` section of the output. Rather than enter all of that manually into a data frame, we can access this section of output and pipe it into `data.frame()`. This will create a data frame of this information. We also assign this into an object so we can use the data in our `ggplot()` function. -->
<!-- ```{r} -->
<!-- #| label: fig-ci-plot-bonferroni -->
<!-- #| fig-cap: "95% Dunn-Bonferroni adjusted simultaneous confidence intervals for the adjusted mean news knowledge scores for Americans who get their news from eight different sources. The means are adjusted for differences in age, education level, amount of news consumed, and political engagement." -->
<!-- #| fig-width: 8 -->
<!-- #| fig-height: 6 -->
<!-- #| out-width: "80%" -->
<!-- # Create data frame of $emmeans section of the output -->
<!-- bonf_ci = confint(bonf, level = 0.9982143)$emmeans |> -->
<!--   data.frame() -->
<!-- # View data frame -->
<!-- bonf_ci -->
<!-- # Create plot of the Dunn-Bonferroni CIs -->
<!-- ggplot(data = bonf_ci, aes(x = emmean, y = news_source)) + -->
<!--   #Create CI -->
<!--   geom_segment(  -->
<!--     aes(x = lower.CL, y = news_source, xend = upper.CL, yend = news_source), -->
<!--     color = "#ff2f92", -->
<!--     linewidth = 1.5 -->
<!--     ) +  -->
<!--   #Add adjusted mean -->
<!--   geom_point(  -->
<!--     size = 3, -->
<!--     color = "#ff2f92" -->
<!--     ) +  -->
<!--   theme_minimal() + -->
<!--   xlab("Adjusted mean news knowledge score") + -->
<!--   ylab("News source(s)") + -->
<!--   xlim(45, 80) -->
<!-- ``` -->
<!-- :::fyi -->
<!-- Confidence intervals that are adjusted for multiple comparisons are sometimes referred to as *simultaneous intervals*.  -->
<!-- ::: -->
<!-- How do we adjust the CIs to correspond to using the Benjamini-Hochberg method for adjusting *p*-values? Unfortunately, this is not as easy since the length of each CI is differentially calculated.   -->
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<!-- ## Technical Appendix: Type I Error Rate and False-Discovery Rate -->
<!-- When we use an alpha value of 0.05 to evaluate consistency of the empirical data to the null hypothesis, we are saying we are willing to make a Type I error in 5% of the samples that could be randomly selected. In other words, we will end up wrongly concluding that the empirical data are inconsistent with the null hypothesis in 5% of the samples we would obtain from our thought experiment. (In practice, we have no idea whether our sample is one of the 5% where we will make an error, or one of the 95% where we won't).  -->
<!-- For effects that only have one row in the model, there is only one test in which we can make a Type I error ($H_0: \beta_j=0$), so we are okay evaluating each using this criterion. When we have more than two levels of a categorical predictor, there are multiple differences that constitute the effect of that predictor. To test whether there is an effect of that predictor, we evaluate *multiple hypothesis tests*. For our data, to test whether there is an effect of family structure on substance use, we evaluate three hypothesis tests: -->
<!-- $$ -->
<!-- \begin{split} -->
<!-- H_0: &\mu_{\mathrm{Two\mbox{-}Parent}} = \mu_{\mathrm{Parent/Guardian}} \\[2ex] -->
<!-- H_0: &\mu_{\mathrm{Two\mbox{-}Parent}} = \mu_{\mathrm{One\mbox{-}Parent}} \\[2ex] -->
<!-- H_0: &\mu_{\mathrm{Parent/Guardian}} = \mu_{\mathrm{One\mbox{-}Parent}} -->
<!-- \end{split} -->
<!-- $$ -->
<!-- Or equivalently, -->
<!-- $$ -->
<!-- \begin{split} -->
<!-- H_0: &\mu_{\mathrm{Two\mbox{-}Parent}} - \mu_{\mathrm{Parent/Guardian}} = 0 \\[2ex] -->
<!-- H_0: &\mu_{\mathrm{Two\mbox{-}Parent}} - \mu_{\mathrm{One\mbox{-}Parent}} = 0 \\[2ex] -->
<!-- H_0: &\mu_{\mathrm{Parent/Guardian}} - \mu_{\mathrm{One\mbox{-}Parent}} = 0 -->
<!-- \end{split} -->
<!-- $$ -->
<!-- Because of this, there are many ways to make a Type I error. For example, we could make a Type I error in any one of the three tests, or in two of the three tests, or in all three of the three tests. Therefore, the probability of making at least one Type I error is no longer 0.05, it is: -->
<!-- $$ -->
<!-- P(\mathrm{type~I~error}) = 1 - (1 - \alpha)^k -->
<!-- $$ -->
<!-- where $\alpha$ is the alpha level for each test, and $k$ is the number of tests (comparisons) for the effect. -->
<!-- In our example this is -->
<!-- $$ -->
<!-- P(\mathrm{type~I~error}) = 1 - (1 -0.05)^{3} = 0.142 -->
<!-- $$ -->
<!-- The probability that we will make *at least one Type I error* in the three tests is around 0.142 NOT 0.05!!! This probability is called the [family-wise Type I error rate](https://en.wikipedia.org/wiki/Family-wise_error_rate) (FWER). This assumes that the *k* tests are independent. If they are not independent, Boole's inequality still suggests that there will be an upper limit on the FWER given by -->
<!-- $$ -->
<!-- \begin{split} -->
<!-- 1 - (1 - \alpha)^{k} &\leq k \times \alpha \\[2ex] -->
<!-- \mathrm{FWER} &\leq k \times \alpha \\[2ex] -->
<!-- \end{split} -->
<!-- $$ -->
<!-- In confirmatory research we often want to limit the probability of any type I errors, so we set the FWER to 0.05. What should $\alpha$ be if we want the FWER to be 0.05? If the three hypothesis tests are independent, essentially we would need to solve this equation for $\alpha$: -->
<!-- $$ -->
<!-- 0.05 = 1 - (1 - \alpha)^{3} -->
<!-- $$ -->
<!-- Even if we are unsure about the independence we know that by solving this equation for $\alpha$, we will have a FWER at or below 0.05: -->
<!-- $$ -->
<!-- 0.05 = 3 \times \alpha -->
<!-- $$ -->
<!-- Setting $\alpha$ to $\dfrac{0.05}{3} = 0.167$ will guarantee our FWER remains at or below 0.05. This is the Dunn--Bonferroni method! -->
<!-- <br /> -->
<!-- ### Benjamini--Hochberg Procedure -->
<!-- The *Benjamini--Hochberg adjustment* tries to minimize [false discovery rate](https://en.wikipedia.org/wiki/False_discovery_rate) (FDR), a more recent approach for assessing how errors in multiple testing could be considered. The FDR is the *expected proportion of all rejected null hypotheses that are rejected erroneously*. Another way to put this is that the FDR is the expected fraction of statistically reliable test statistics (with $p<.05$) that are false discoveries. -->
<!-- The Benjamini--Hochberg adjustment uses the following procedure to control FDR: -->
<!-- 1. Conduct *k* separate *t*-tests, each at the common significance level $\alpha$ (in the social sciences, 0.05). -->
<!-- 2. Rank order the *p*-values of the *k* tests from smallest to largest, where $p_1 \leq p_2 \leq \ldots \leq p_k$ are the rank ordered *p*-values. -->
<!-- 3. Define *m* as the maximum $j$ for which $p_j \leq \frac{j}{k} \times\alpha$. -->
<!-- 4. Reject all null hypotheses $H_{0_j}$ $j = 1, 2, \ldots, m$. If no such *m* exists, then no hypotheses are rejected. -->
<!-- This boils down to essentially, rank ordering the unadjusted *p*-values from smallest to largest and then adjusting each *p*-value  by the following computation^[The actual adjusted *p*-value given is the minimum of this value and the adjusted *p*-value for the next higher raw *p*-value.]: -->
<!-- $$ -->
<!-- p_{\mathrm{adjusted}} = \frac{k \times p_{\mathrm{unadjusted}}}{\mathrm{Rank}} -->
<!-- $$ -->
<!-- In this adjustment, the numerator is equivalent to making the Bonferroni adjustment. The size of the Bonferroni adjustment is then scaled back depending on the initial rank of the unadjusted *p*-value. The smallest initial *p*-value gets the complete Bonferroni adjustment, while the largest Bonferroni adjustment is scaled back the most.  -->
<!-- <br /> -->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Benjamini:1995" class="csl-entry" role="listitem">
Benjamini, Y., &amp; Hochberg, Y. (1995). Controlling the false discovery rate: A practical and powerful approach to multiple testing. <em>Journal of the Royal Statistical Society, Series B</em>, <em>57</em>(1), 289—300.
</div>
<div id="ref-Dunn:1961" class="csl-entry" role="listitem">
Dunn, O. J. (1961). Multiple comparisons among means. <em>Journal of the American Statistical Association</em>, <em>56</em>(293), 52–64.
</div>
<div id="ref-Holm:1979" class="csl-entry" role="listitem">
Holm, S. (1979). A simple sequentially rejective multiple test procedure. <em>Scandinavian Journal of Statistics</em>, <em>6</em>(2), 65–70. <a href="http://www.jstor.org/stable/4615733">http://www.jstor.org/stable/4615733</a>
</div>
<div id="ref-Scheffe:1959" class="csl-entry" role="listitem">
Scheffé, H. (1959). <em>The analysis of variance</em>. Wiley.
</div>
<div id="ref-Tukey:1949" class="csl-entry" role="listitem">
Tukey, J. W. (1949). Comparing individual means in the <span>A</span>nalysis of <span>V</span>ariance. <em>Biometrics</em>, <em>5</em>(2), 99–114.
</div>
<div id="ref-Whalley:2018" class="csl-entry" role="listitem">
Whalley, B. (2018). <em>Just enough r</em>. <a href="https://benwhalley.github.io/just-enough-r/">https://benwhalley.github.io/just-enough-r/</a>
</div>
<div id="ref-What-Works-Clearinghouse:2020" class="csl-entry" role="listitem">
What Works Clearinghouse. (2020). <em>Procedures handbook, version 4.1</em> (No. ED602035). National Center for Education Evaluation; Regional Assistance, Institute of Education Sciences, U.S. Department of Education. <a href="http://ies.ed.gov/ncee/wwc/Handbooks">http://ies.ed.gov/ncee/wwc/Handbooks</a>
</div>
<div id="ref-Williams:1999" class="csl-entry" role="listitem">
Williams, V. S. L., Jones, L. V., &amp; Tukey, J. W. (1999). Controlling error in multiple comparisons, with examples from state-to-state differences in educational achievement. <em>Journal of Educational and Behavioral Statistics</em>, <em>24</em>(1), 42–69.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This is probably high in practice.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Alternatively, when researchers spell out ALL of the hypotheses they will test prior to looking at the data (and those tests are driven from the literature), they are taking a <em>confirmatory approach</em> to hypothesis testing.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>In our patriarchal society, unfortunately Olive Dunn’s name is often removed from the nomenclature, and this adjustment gets referred to as the “Bonferroni adjustment”.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>A “contrast” is what statisticians call a difference; they are contrasting two groups.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>