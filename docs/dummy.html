<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Dichotomous Categorical Predictors | Statistical Modeling and Computation for Educational Scientists" />
<meta property="og:type" content="book" />

<meta property="og:description" content="EPsy 8251 and 8252 Notes" />
<meta name="github-repo" content="zief0002/modeling" />

<meta name="author" content="Andrew Zieffler" />

<meta name="date" content="2022-09-26" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="EPsy 8251 and 8252 Notes">

<title>Dichotomous Categorical Predictors | Statistical Modeling and Computation for Educational Scientists</title>

<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap/js/bootstrap.min.js"></script>
<script src="libs/bootstrap/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation/tabsets.js"></script>
<script src="libs/kePrint/kePrint.js"></script>
<link href="libs/lightable/lightable.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style/style.css" type="text/css" />
<link rel="stylesheet" href="style/table-styles.css" type="text/css" />
<link rel="stylesheet" href="style/syntax.css" type="text/css" />
<link rel="stylesheet" href="style/navbar.css" type="text/css" />
<link rel="stylesheet" href="style/notes.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#foreword" id="toc-foreword">Foreword</a></li>
<li><a href="preface.html#preface" id="toc-preface">Preface</a></li>
<li><a href="slrd.html#slrd" id="toc-slrd">Simple Linear Regression—Description</a></li>
<li><a href="ordinary-least-squares-ols-estimation.html#ordinary-least-squares-ols-estimation" id="toc-ordinary-least-squares-ols-estimation">Ordinary Least Squares (OLS) Estimation</a></li>
<li><a href="cor.html#cor" id="toc-cor">Correlation and Standardized Regression</a></li>
<li><a href="coefinf.html#coefinf" id="toc-coefinf">Coefficient-Level Inference</a></li>
<li><a href="modinf.html#modinf" id="toc-modinf">Model-Level Inference</a></li>
<li><a href="multreg.html#multreg" id="toc-multreg">Introduction to Multiple Regression</a></li>
<li><a href="statcontrol.html#statcontrol" id="toc-statcontrol">Understanding Statistical Control</a></li>
<li><a href="assumptions.html#assumptions" id="toc-assumptions">Distributional Assumptions Underlying the Regression Model</a></li>
<li><a href="dummy.html#dummy" id="toc-dummy">Dichotomous Categorical Predictors</a></li>
<li><a href="polychotomous.html#polychotomous" id="toc-polychotomous">Polychotomous Categorical Predictors</a></li>
<li><a href="interaction-01.html#interaction-01" id="toc-interaction-01">Introduction to Interaction Effects</a></li>
<li><a href="interaction-02.html#interaction-02" id="toc-interaction-02">More Interaction Effects</a></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="dummy" class="section level1">
<h1>Dichotomous Categorical Predictors</h1>
<p>In this chapter, you will learn about how to include dichotomous categorical predictors (i.e., predictors with two levels) in the regression model. To do so, we will use the <a href="https://raw.githubusercontent.com/zief0002/modeling/master/data/mn-schools.csv">mn-schools.csv</a> data to examine whether there are differences in graduation rate between public and private colleges and universities (see the <a href="http://zief0002.github.io/epsy-8251/codebooks/mn-schools.html">data codebook</a>). To begin, we will load several libraries and import the data into an object called <code>mn</code>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="dummy.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb145-2"><a href="dummy.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb145-3"><a href="dummy.html#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb145-4"><a href="dummy.html#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb145-5"><a href="dummy.html#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(educate)</span>
<span id="cb145-6"><a href="dummy.html#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb145-7"><a href="dummy.html#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb145-8"><a href="dummy.html#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb145-9"><a href="dummy.html#cb145-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-10"><a href="dummy.html#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb145-11"><a href="dummy.html#cb145-11" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;https://raw.githubusercontent.com/zief0002/modeling/master/data/mn-schools.csv&quot;</span>)</span>
<span id="cb145-12"><a href="dummy.html#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mn)</span></code></pre></div>
<pre><code># A tibble: 6 × 5
  name                               grad sector    sat tuition
  &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 Augsburg College                   65.2 Private  1030    39.3
2 Bethany Lutheran College           52.6 Private  1065    30.5
3 Bethel University, Saint Paul, MN  73.3 Private  1145    39.4
4 Carleton College                   92.6 Private  1400    54.3
5 College of Saint Benedict          81.1 Private  1185    43.2
6 Concordia College at Moorhead      69.4 Private  1145    36.6</code></pre>
<p><br /></p>
<div id="data-exploration-2" class="section level2">
<h2>Data Exploration</h2>
<p>To begin, as always, we will plot the marginal distributions of graduation rates (<code>grad</code>) and educational sector (<code>sector</code>). Since educational sector is a categorical variable, rather than creating a density plot of the marginal distribution, we will create a bar plot. We will also create a scatterplot of graduation rates versus educational sector.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="dummy.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot of graduation rates</span></span>
<span id="cb147-2"><a href="dummy.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> grad)) <span class="sc">+</span></span>
<span id="cb147-3"><a href="dummy.html#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#c62f4b&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-4"><a href="dummy.html#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb147-5"><a href="dummy.html#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Six-year graduation rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-6"><a href="dummy.html#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability density&quot;</span>)</span>
<span id="cb147-7"><a href="dummy.html#cb147-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-8"><a href="dummy.html#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot of education sector</span></span>
<span id="cb147-9"><a href="dummy.html#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> sector)) <span class="sc">+</span></span>
<span id="cb147-10"><a href="dummy.html#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">&quot;#c62f4b&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-11"><a href="dummy.html#cb147-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb147-12"><a href="dummy.html#cb147-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Educational sector&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-13"><a href="dummy.html#cb147-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb147-14"><a href="dummy.html#cb147-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-15"><a href="dummy.html#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb147-16"><a href="dummy.html#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> sector, <span class="at">y =</span> grad)) <span class="sc">+</span></span>
<span id="cb147-17"><a href="dummy.html#cb147-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb147-18"><a href="dummy.html#cb147-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb147-19"><a href="dummy.html#cb147-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Educational sector&quot;</span>) <span class="sc">+</span></span>
<span id="cb147-20"><a href="dummy.html#cb147-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Six-year graduation rate&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-156"></span>
<img src="Modeling-in-Education_files/figure-html/unnamed-chunk-156-1.png" alt="LEFT: Density plot of six-year graduation rates. CENTER: Bar plot of education sector. RIGHT: Scatterplot of the six-year graduation rate versus educational sector." width="30%" /><img src="Modeling-in-Education_files/figure-html/unnamed-chunk-156-2.png" alt="LEFT: Density plot of six-year graduation rates. CENTER: Bar plot of education sector. RIGHT: Scatterplot of the six-year graduation rate versus educational sector." width="30%" /><img src="Modeling-in-Education_files/figure-html/unnamed-chunk-156-3.png" alt="LEFT: Density plot of six-year graduation rates. CENTER: Bar plot of education sector. RIGHT: Scatterplot of the six-year graduation rate versus educational sector." width="30%" />
<p class="caption">
Figure 64: LEFT: Density plot of six-year graduation rates. CENTER: Bar plot of education sector. RIGHT: Scatterplot of the six-year graduation rate versus educational sector.
</p>
</div>
<p>We will also compute the means, standard deviations, and sample sizes for private and public schools.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="dummy.html#cb148-1" aria-hidden="true" tabindex="-1"></a>mn <span class="sc">%&gt;%</span> </span>
<span id="cb148-2"><a href="dummy.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector) <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="dummy.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb148-4"><a href="dummy.html#cb148-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">mean</span>(grad),</span>
<span id="cb148-5"><a href="dummy.html#cb148-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(grad),</span>
<span id="cb148-6"><a href="dummy.html#cb148-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">length</span>(grad)</span>
<span id="cb148-7"><a href="dummy.html#cb148-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<table style="width:40%; margin-left: auto; margin-right: auto;" class="table">
<caption>
<span id="tab:unnamed-chunk-158">Table 14: </span>Mean (M), standard deviation (SD), and sample size (N) of the six-year graduation rates for 33 Minnesota colleges and universities conditioned on educational sector.
</caption>
<thead>
<tr>
<th style="text-align:left;text-align: center;">
Sector
</th>
<th style="text-align:center;text-align: center;">
M
</th>
<th style="text-align:center;text-align: center;">
SD
</th>
<th style="text-align:center;text-align: center;">
N
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Private
</td>
<td style="text-align:center;">
65.27
</td>
<td style="text-align:center;">
17.58
</td>
<td style="text-align:center;">
23
</td>
</tr>
<tr>
<td style="text-align:left;">
Public
</td>
<td style="text-align:center;">
51.03
</td>
<td style="text-align:center;">
9.16
</td>
<td style="text-align:center;">
10
</td>
</tr>
</tbody>
</table>
<p>We note a couple differences in the distribution of graduation rates between public and private schools. First, the mean graduation rates are different. Private schools have a graduation rate that is, on average, 14.2 percentage points higher than public schools. There is also more variation in private schools’ graduation rates than in public schools’ graduation rates. Lastly, we note that the sample sizes are not equal. There are 13 more private schools than there are public schools in the data set.</p>
<p><br /></p>
</div>
<div id="indicator-variables" class="section level2">
<h2>Indicator Variables</h2>
<p>Before we can compute correlations or fit a regression model, we need to convert educational sector into a numeric variable. In this numeric variable, we will assign the public schools one value, and the private schools another value. The numbers are just stand-ins for the category. As such, they are referred to as <em>indicator variables</em>, since the numerical values only indicate a category.</p>
<p>For example, here we will code public schools as 5 and private schools as 10. To create this new indicator variable, we <code>mutate()</code> a new column (called <code>indicator</code>) onto our <code>mn</code> data frame that takes the value of 5 if <code>sector</code> is <code>Public</code> and 10 if <code>sector</code> is <code>Private</code>. Here we use the <code>if_else()</code> function to carry out this logic.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="dummy.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create indicator variable</span></span>
<span id="cb149-2"><a href="dummy.html#cb149-2" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">=</span> mn <span class="sc">%&gt;%</span></span>
<span id="cb149-3"><a href="dummy.html#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb149-4"><a href="dummy.html#cb149-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">indicator =</span> <span class="fu">if_else</span>(sector <span class="sc">==</span> <span class="st">&quot;Public&quot;</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb149-5"><a href="dummy.html#cb149-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb149-6"><a href="dummy.html#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="dummy.html#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine data frame</span></span>
<span id="cb149-8"><a href="dummy.html#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mn)</span></code></pre></div>
<pre><code># A tibble: 6 × 6
  name                               grad sector    sat tuition indicator
  &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1 Augsburg College                   65.2 Private  1030    39.3        10
2 Bethany Lutheran College           52.6 Private  1065    30.5        10
3 Bethel University, Saint Paul, MN  73.3 Private  1145    39.4        10
4 Carleton College                   92.6 Private  1400    54.3        10
5 College of Saint Benedict          81.1 Private  1185    43.2        10
6 Concordia College at Moorhead      69.4 Private  1145    36.6        10</code></pre>
<p>Now, we can then use this new indicator variable in correlation and regression analyses.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="dummy.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation</span></span>
<span id="cb151-2"><a href="dummy.html#cb151-2" aria-hidden="true" tabindex="-1"></a>mn <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="dummy.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(grad, indicator) <span class="sc">%&gt;%</span></span>
<span id="cb151-4"><a href="dummy.html#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb151-5"><a href="dummy.html#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fashion</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>       term  grad indicator
1      grad            .397
2 indicator  .397          </code></pre>
<p>The correlation between educational sector and graduation rate is small and positive, indicating that institutions with higher graduation rates tend to have higher values on the indicator variable. Since there are only two values mapped to the <code>sector</code> variable, this implies that institutions with higher graduation rates tend to be private institutions.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="dummy.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb153-2"><a href="dummy.html#cb153-2" aria-hidden="true" tabindex="-1"></a>lm.a <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> indicator, <span class="at">data =</span> mn)</span>
<span id="cb153-3"><a href="dummy.html#cb153-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-4"><a href="dummy.html#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb153-5"><a href="dummy.html#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glance</span>(lm.a), <span class="at">width =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.158         0.130  15.6      5.80  0.0222     1  -136.  279.  283.
  deviance df.residual  nobs
     &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1    7552.          31    33</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="dummy.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb155-2"><a href="dummy.html#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.a)</span></code></pre></div>
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)    36.8      10.4       3.54 0.00129
2 indicator       2.85      1.18      2.41 0.0222 </code></pre>
<div class="fyi">
<p>Chaining the <code>glance()</code> output in the <code>print()</code> function allows us to include the argument <code>width=Inf</code>. This argument prints ALL the columns from the <code>glance()</code> output instead of truncating the output. This hack can also be used to print all of the columns from a data frame that gets truncated as well.</p>
</div>
<p>Differences in these indicator values (i.e., educational sector) explain 15.75% of the variation in graduation rates. This is statistically reliable, <span class="math inline">\(F(1, 31) = 5.80\)</span>, <span class="math inline">\(p=0.022\)</span>. Interpreting the coefficients,</p>
<ul>
<li>The average graduation rate for schools coded as 0 on the indicator variable is 36.8% (<span class="math inline">\(t(31)=3.54\)</span>, <span class="math inline">\(p = 0.001\)</span>). Since the mapping we used (5 and 10) did not include 0, the intercept and inferential information related to the intercept are meaningless.</li>
<li>Institutions that have coding values that are one-unit differences have, on average, a graduation rate that is 2.85 percentage points different (<span class="math inline">\(t(31)=2.41\)</span>, <span class="math inline">\(p=0.022\)</span>). The slope information in its current form is also meaningless. But, since the model is linear, we can translate the slope information to be more meaningful. In our mapping, the difference between public and private schools was a 5-point difference. We can use this to compute the difference in graduation rates between these two sectors,</li>
</ul>
<p><span class="math display">\[
\mathrm{Difference} = 5 \times 2.85 = 14.3
\]</span></p>
<p>We could also have substituted the mapped values of 5 and 10 into the fitted regression equation to obtain the same result. Substituting the indicator values into the fitted equation, we find the predicted average graduation rates for public and private schools:</p>
<p><span class="math display">\[
\begin{split}
\mathbf{Private:~}\hat{\mathrm{Graduation~Rate}_i} &amp;= 36.8 + 2.85(10) = 65.3 \\[2ex]
\mathbf{Public:~}\hat{\mathrm{Graduation~Rate}_i} &amp;= 36.8 + 2.85(5) = 51 \\[2ex]
\end{split}
\]</span>
The difference in these average graduation rates comes out to 14.3. The <em>p</em>-value associated with the slope coefficient suggests that this difference (or any difference between different values of <em>X</em> computed from the model) is more than we expect because of chance, so we conclude that there is a difference between the average graduation rates of public and private schools. What if we would have used different values in the indicator variable. Let’s try this mapping:</p>
<p><span class="math display">\[
\mathrm{Indicator}_2 = \begin{cases}
2 \quad \mathrm{for~Public}\\
7 \quad \mathrm{for~Private}
\end{cases}
\]</span></p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="dummy.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create indicator variable</span></span>
<span id="cb157-2"><a href="dummy.html#cb157-2" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">=</span> mn <span class="sc">%&gt;%</span></span>
<span id="cb157-3"><a href="dummy.html#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb157-4"><a href="dummy.html#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">indicator_2 =</span> <span class="fu">if_else</span>(sector <span class="sc">==</span> <span class="st">&quot;Public&quot;</span>, <span class="dv">2</span>, <span class="dv">7</span>)</span>
<span id="cb157-5"><a href="dummy.html#cb157-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb157-6"><a href="dummy.html#cb157-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-7"><a href="dummy.html#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine data frame</span></span>
<span id="cb157-8"><a href="dummy.html#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mn)</span></code></pre></div>
<pre><code># A tibble: 6 × 7
  name                               grad sector    sat tuition indica…¹ indic…²
  &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 Augsburg College                   65.2 Private  1030    39.3       10       7
2 Bethany Lutheran College           52.6 Private  1065    30.5       10       7
3 Bethel University, Saint Paul, MN  73.3 Private  1145    39.4       10       7
4 Carleton College                   92.6 Private  1400    54.3       10       7
5 College of Saint Benedict          81.1 Private  1185    43.2       10       7
6 Concordia College at Moorhead      69.4 Private  1145    36.6       10       7
# … with abbreviated variable names ¹​indicator, ²​indicator_2</code></pre>
<p>Using this second indicator to compute correlations and in the regression model, we find:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="dummy.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation</span></span>
<span id="cb159-2"><a href="dummy.html#cb159-2" aria-hidden="true" tabindex="-1"></a>mn <span class="sc">%&gt;%</span></span>
<span id="cb159-3"><a href="dummy.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(grad, indicator_2) <span class="sc">%&gt;%</span></span>
<span id="cb159-4"><a href="dummy.html#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb159-5"><a href="dummy.html#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fashion</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>         term  grad indicator_2
1        grad              .397
2 indicator_2  .397            </code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="dummy.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb161-2"><a href="dummy.html#cb161-2" aria-hidden="true" tabindex="-1"></a>lm.b <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> indicator_2, <span class="at">data =</span> mn)</span>
<span id="cb161-3"><a href="dummy.html#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="dummy.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb161-5"><a href="dummy.html#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glance</span>(lm.b), <span class="at">width =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.158         0.130  15.6      5.80  0.0222     1  -136.  279.  283.
  deviance df.residual  nobs
     &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1    7552.          31    33</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="dummy.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb163-2"><a href="dummy.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.b)</span></code></pre></div>
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic     p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 (Intercept)    45.3       7.03      6.45 0.000000346
2 indicator_2     2.85      1.18      2.41 0.0222     </code></pre>
<p>The correlation between educational sector and graduation rate and the model-level output is exactly the same. Institutions with higher graduation rates tend to have higher values on the indicator variable (private institutions). Differences in these indicator values (i.e., educational sector) explain 15.75% of the variation in graduation rates. This is statistically reliable, <span class="math inline">\(F(1, 31) = 5.80\)</span>, <span class="math inline">\(p=0.022\)</span>.</p>
<p>In the coefficient-level output, the slope output is the same as when we used the values of 5 and 10 (<span class="math inline">\(\hat\beta_1=2.85\)</span>, <span class="math inline">\(t(31)=2.41\)</span>, <span class="math inline">\(p=0.022\)</span>). Institutions that have coding values that are one-unit differences have, on average, a graduation rate that is 2.85 percentage points different (<span class="math inline">\(t(31)=2.41\)</span>, <span class="math inline">\(p=0.022\)</span>). Substituting the indicator values into the fitted equation, we find the predicted average graduation rates for public and private schools:</p>
<p><span class="math display">\[
\begin{split}
\mathbf{Private:~}\hat{\mathrm{Graduation~Rate}_i} &amp;= 45.3 + 2.85(7) = 65.25 \\[2ex]
\mathbf{Public:~}\hat{\mathrm{Graduation~Rate}_i} &amp;= 45.3 + 2.85(2) = 51 \\[2ex]
\end{split}
\]</span></p>
<p>The intercept coefficient, and subsequently inferential output, are different. This is because in our second indicator variable, the code of 0 is in a different location relative to the values of 2 and 7 than it was when we used 5 and 10. In reality, it doesn’t matter because 0 is not a legitimate mapping in either indicator variable (remember the values represent categories!).</p>
<p><br /></p>
<div id="dummy-coding" class="section level3">
<h3>Dummy Coding</h3>
<p>Since regardless of the values we choose for the indicator variable, we get similar results we can make use of the interpretational value of the intercept and slope to help select our mapped values. For example, since the intercept is the average <em>Y</em>-value for an <em>X</em>-value of 0, we should choose on of our mapped values to be 0. Also, since the slope gives us a difference in the average <em>Y</em>-value for a one-unit difference in <em>X</em>, we can choose our other value to correspond to a mapping that is one-unit higher than 0, namely 1. Our mapping is then,</p>
<p><span class="math display">\[
\mathrm{Indicator} = \begin{cases}
0 \quad \mathrm{for~Public}\\
1 \quad \mathrm{for~Private}
\end{cases}
\]</span></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="dummy.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create indicator variable</span></span>
<span id="cb165-2"><a href="dummy.html#cb165-2" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">=</span> mn <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="dummy.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb165-4"><a href="dummy.html#cb165-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">private =</span> <span class="fu">if_else</span>(sector <span class="sc">==</span> <span class="st">&quot;Private&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb165-5"><a href="dummy.html#cb165-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb165-6"><a href="dummy.html#cb165-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-7"><a href="dummy.html#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine data frame</span></span>
<span id="cb165-8"><a href="dummy.html#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mn)</span></code></pre></div>
<pre><code># A tibble: 6 × 8
  name                         grad sector   sat tuition indic…¹ indic…² private
  &lt;chr&gt;                       &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 Augsburg College             65.2 Priva…  1030    39.3      10       7       1
2 Bethany Lutheran College     52.6 Priva…  1065    30.5      10       7       1
3 Bethel University, Saint P…  73.3 Priva…  1145    39.4      10       7       1
4 Carleton College             92.6 Priva…  1400    54.3      10       7       1
5 College of Saint Benedict    81.1 Priva…  1185    43.2      10       7       1
6 Concordia College at Moorh…  69.4 Priva…  1145    36.6      10       7       1
# … with abbreviated variable names ¹​indicator, ²​indicator_2</code></pre>
<p>Using a 0, and 1 coding for an indicator variable is referred to as <em>dummy coding</em>. Conventionally, we name an indicator variable that employs dummy coding with the category that is mapped to 1. In the syntax, private schools are mapped to 1, and hence the indicator variable is named <code>private</code>. The category mapped to 0 is known as the <em>reference category</em>, or <em>reference group</em>. Here public schools are the reference group.</p>
<p>Using the dummy coded indicator to compute correlations and fit the regression model, we find:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="dummy.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation</span></span>
<span id="cb167-2"><a href="dummy.html#cb167-2" aria-hidden="true" tabindex="-1"></a>mn <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="dummy.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(grad, private) <span class="sc">%&gt;%</span></span>
<span id="cb167-4"><a href="dummy.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb167-5"><a href="dummy.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fashion</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>     term  grad private
1    grad          .397
2 private  .397        </code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="dummy.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb169-2"><a href="dummy.html#cb169-2" aria-hidden="true" tabindex="-1"></a>lm.c <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> private, <span class="at">data =</span> mn)</span>
<span id="cb169-3"><a href="dummy.html#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="dummy.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb169-5"><a href="dummy.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glance</span>(lm.c), <span class="at">width =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.158         0.130  15.6      5.80  0.0222     1  -136.  279.  283.
  deviance df.residual  nobs
     &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1    7552.          31    33</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="dummy.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb171-2"><a href="dummy.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.c)</span></code></pre></div>
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     51.0      4.94     10.3  1.44e-11
2 private         14.2      5.91      2.41 2.22e- 2</code></pre>
<p>The correlation between educational sector and graduation rate and the model-level output is exactly the same. Institutions with higher graduation rates tend to have higher values on the indicator variable (private institutions). Differences in these indicator values (i.e., educational sector) explain 15.75% of the variation in graduation rates. This is statistically reliable, <span class="math inline">\(F(1, 31) = 5.80\)</span>, <span class="math inline">\(p=0.022\)</span>.</p>
<p>The fitted equation is:</p>
<p><span class="math display">\[
\hat{\mathrm{Graduation~Rate}_i} = 51 + 14.2(\mathrm{Private_i})
\]</span></p>
<p>Interpreting the coefficients,</p>
<ul>
<li>The average graduation rate for schools coded as 0 on the indicator variable is 51%.</li>
<li>Each one-unit difference on the indicator variable have, on average, a graduation rate that is 14.2 percentage points different.</li>
</ul>
<p>Since 0 represented the private schools the intercept is the average graduation rate for public schools. In general, when using dummy coding, the intercept will be the average <em>Y</em>-value for the reference group. The inferential test, <span class="math inline">\(H_0:\beta_0=0\)</span>, tests whether the average <em>Y</em>-value for the reference group is 0. (Sometimes this is relevant and other times it is not, depending whether this is of substantive interest.) In our example, we find that the empirical data is not consistent with the average graduation rate for public schools being 0%; <span class="math inline">\(t(31)=10.34\)</span>, <span class="math inline">\(p &lt; 0.001\)</span>.</p>
<p>The slope coefficient now represents the difference in average graduation rates between public and private schools as their dummy codes were one-unit apart. In general, when using dummy coding, the slope gives the difference between the category labeled 1 and the reference group. The test of the parameter, <span class="math inline">\(H_0:\beta_1=0\)</span>, is a direct test of whether the difference in average graduation rates is different than 0; or that public and private schools having the same graduation rate. Here we find that the empirical data is not consistent with the average graduation rates between public and private schools being the same; <span class="math inline">\(t(31)=2.41\)</span>, <span class="math inline">\(p=0.022\)</span>.</p>
<p>Putting these contextual queues around the interpretations, we interpret the coefficients as:</p>
<ul>
<li>The average graduation rate for public schools is 51%.</li>
<li>Private schools have a graduation rate that is 14.2 percentage points, on average, higher than public schools.</li>
</ul>
<p><br /></p>
</div>
<div id="making-private-schools-the-reference-group" class="section level3">
<h3>Making Private Schools the Reference Group</h3>
<p>What happens if we had coded the predictor so that private schools were the reference group (coded as 0), and public schools were coded as 1?</p>
<pre><code># A tibble: 6 × 9
  name                  grad sector   sat tuition indic…¹ indic…² private public
  &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 Augsburg College      65.2 Priva…  1030    39.3      10       7       1      0
2 Bethany Lutheran Co…  52.6 Priva…  1065    30.5      10       7       1      0
3 Bethel University, …  73.3 Priva…  1145    39.4      10       7       1      0
4 Carleton College      92.6 Priva…  1400    54.3      10       7       1      0
5 College of Saint Be…  81.1 Priva…  1185    43.2      10       7       1      0
6 Concordia College a…  69.4 Priva…  1145    36.6      10       7       1      0
# … with abbreviated variable names ¹​indicator, ²​indicator_2</code></pre>
<p>Using the dummy coded indicator to compute correlations and fit the regression model, we find:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="dummy.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation</span></span>
<span id="cb174-2"><a href="dummy.html#cb174-2" aria-hidden="true" tabindex="-1"></a>mn <span class="sc">%&gt;%</span></span>
<span id="cb174-3"><a href="dummy.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(grad, public) <span class="sc">%&gt;%</span></span>
<span id="cb174-4"><a href="dummy.html#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb174-5"><a href="dummy.html#cb174-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fashion</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>    term  grad public
1   grad        -.397
2 public -.397       </code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="dummy.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb176-2"><a href="dummy.html#cb176-2" aria-hidden="true" tabindex="-1"></a>lm.d <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> public, <span class="at">data =</span> mn)</span>
<span id="cb176-3"><a href="dummy.html#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="dummy.html#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb176-5"><a href="dummy.html#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glance</span>(lm.d), <span class="at">width =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.158         0.130  15.6      5.80  0.0222     1  -136.  279.  283.
  deviance df.residual  nobs
     &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1    7552.          31    33</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="dummy.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb178-2"><a href="dummy.html#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.d)</span></code></pre></div>
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)     65.3      3.25     20.1  2.61e-19
2 public         -14.2      5.91     -2.41 2.22e- 2</code></pre>
<p>The correlations and model-level output are exactly the same, except that the sign on the correlation is now negative since we switched the order of the coding so that private schools were mapped to a lower value (0) and public school were mapped to a higher value (1). The fitted equation is:</p>
<p><span class="math display">\[
\hat{\mathrm{Graduation~Rate}_i} = 65.3 - 14.2(\mathrm{Public_i})
\]</span></p>
<p>Interpreting the coefficients,</p>
<ul>
<li>The average graduation rate for private schools is 65.3%.</li>
<li>Public schools have a graduation rate that is 14.2 percentage points, on average, lower than private schools.</li>
</ul>
<p>The inferential test for the intercept now examines whether the average graduation rate for private schools (reference group) is different than 0%. The test for slope is still evaluating whether there is a difference between the average graduation rates between private and public schools. Although the coefficient has the opposite sign, the <em>p</em>-value is still identical.</p>
<p><br /></p>
</div>
</div>
<div id="assumption-checking" class="section level2">
<h2>Assumption Checking</h2>
<p>Like any other regression model, we need to examine whether or not the model’s assumptions are tenable. We look at (1) the marginal distribution of the standardized residuals, and (2) the scatterplot of the standardized residuals versus the model’s fitted values. The only difference is that <em>with only categorical predictors in the model, we do not have to worry about the linearity assumption</em>. Since there is no ordinal quality to the predictor space, the average residual will always be zero when there are only categorical predictors in the model. (Once we add any quantitative covariates we will again have to evaluate this assumption.)</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="dummy.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the fitted values and residuals</span></span>
<span id="cb180-2"><a href="dummy.html#cb180-2" aria-hidden="true" tabindex="-1"></a>aug_d <span class="ot">=</span> <span class="fu">augment</span>(lm.d)</span>
<span id="cb180-3"><a href="dummy.html#cb180-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-4"><a href="dummy.html#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View augmented data frame</span></span>
<span id="cb180-5"><a href="dummy.html#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aug_d)</span></code></pre></div>
<pre><code># A tibble: 6 × 8
   grad public .fitted   .resid   .hat .sigma     .cooksd .std.resid
  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
1  65.2      0    65.3  -0.0652 0.0435   15.9 0.000000415   -0.00427
2  52.6      0    65.3 -12.7    0.0435   15.7 0.0156        -0.830  
3  73.3      0    65.3   8.03   0.0435   15.8 0.00630        0.526  
4  92.6      0    65.3  27.3    0.0435   15.0 0.0729         1.79   
5  81.1      0    65.3  15.8    0.0435   15.6 0.0245         1.04   
6  69.4      0    65.3   4.13   0.0435   15.8 0.00167        0.271  </code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="dummy.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot of the marginal standardized residuals</span></span>
<span id="cb182-2"><a href="dummy.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> aug_d, <span class="fu">aes</span>(<span class="at">x =</span> .std.resid)) <span class="sc">+</span></span>
<span id="cb182-3"><a href="dummy.html#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_confidence</span>(<span class="at">model =</span><span class="st">&quot;normal&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-4"><a href="dummy.html#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#c62f4b&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-5"><a href="dummy.html#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb182-6"><a href="dummy.html#cb182-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Standardized residual&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-7"><a href="dummy.html#cb182-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability density&quot;</span>)</span>
<span id="cb182-8"><a href="dummy.html#cb182-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-9"><a href="dummy.html#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot of the standardized residuals versus the fitted values</span></span>
<span id="cb182-10"><a href="dummy.html#cb182-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> aug_d, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .std.resid)) <span class="sc">+</span></span>
<span id="cb182-11"><a href="dummy.html#cb182-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb182-12"><a href="dummy.html#cb182-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb182-13"><a href="dummy.html#cb182-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb182-14"><a href="dummy.html#cb182-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Fitted value&quot;</span>) <span class="sc">+</span></span>
<span id="cb182-15"><a href="dummy.html#cb182-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Standardized residual&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-168"></span>
<img src="Modeling-in-Education_files/figure-html/unnamed-chunk-168-1.png" alt="LEFT: Density plot of the marginal distribution of standardized residuals from a regression model using educational sector to predict variation in six-year graduation rates (raspberry line). The sampling uncertainty associated with the normal distribution is also displayed (blue shaded area). RIGHT: Scatterplot of the standardized residuals versus the fitted values from the same model. A horizontal line at $Y=0$ shows the expected mean residual under the linearity assumption. The loess line (blue) and uncertainty bands (grey shaded area) are also displayed." width="45%" /><img src="Modeling-in-Education_files/figure-html/unnamed-chunk-168-2.png" alt="LEFT: Density plot of the marginal distribution of standardized residuals from a regression model using educational sector to predict variation in six-year graduation rates (raspberry line). The sampling uncertainty associated with the normal distribution is also displayed (blue shaded area). RIGHT: Scatterplot of the standardized residuals versus the fitted values from the same model. A horizontal line at $Y=0$ shows the expected mean residual under the linearity assumption. The loess line (blue) and uncertainty bands (grey shaded area) are also displayed." width="45%" />
<p class="caption">
Figure 65: LEFT: Density plot of the marginal distribution of standardized residuals from a regression model using educational sector to predict variation in six-year graduation rates (raspberry line). The sampling uncertainty associated with the normal distribution is also displayed (blue shaded area). RIGHT: Scatterplot of the standardized residuals versus the fitted values from the same model. A horizontal line at <span class="math inline">\(Y=0\)</span> shows the expected mean residual under the linearity assumption. The loess line (blue) and uncertainty bands (grey shaded area) are also displayed.
</p>
</div>
<p>From the scatterplot, we see that there is some question about the tenability of the equal variances assumption. The variation in the private schools’ residuals seems greater than the variation in the public schools’ residuals. (This was foreshadowed earlier when we examined the standard deviations of the two distributions.) This difference in variation, however, might be due to the extreme private school that has a residual that is less than <span class="math inline">\(-2\)</span>. Additionally, this assumption violation might not be a problem once we add other predictors to the model. So, for now, we will move on, but will re-check this assumption after fitting additional models.</p>
<p>The <em>marginal</em> distribution of the residuals does not show evidence of mis-fit with the normality assumption. Since the predictor has only two levels, we could actually examine the distribution of residuals for each sector. Here we do so as a pedagogical example, but note that once other non-categorical predictors are included, this can no longer be done. To examine the conditional distributions, we will filter the augmented data by sector and then plot each sector’s residuals separately.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="dummy.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get private schools</span></span>
<span id="cb183-2"><a href="dummy.html#cb183-2" aria-hidden="true" tabindex="-1"></a>aug_private <span class="ot">=</span> aug_d <span class="sc">%&gt;%</span> </span>
<span id="cb183-3"><a href="dummy.html#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(public <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb183-4"><a href="dummy.html#cb183-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-5"><a href="dummy.html#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get public schools</span></span>
<span id="cb183-6"><a href="dummy.html#cb183-6" aria-hidden="true" tabindex="-1"></a>aug_public <span class="ot">=</span> aug_d <span class="sc">%&gt;%</span> </span>
<span id="cb183-7"><a href="dummy.html#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(public <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb183-8"><a href="dummy.html#cb183-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-9"><a href="dummy.html#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot of the private schools&#39; standardized residuals</span></span>
<span id="cb183-10"><a href="dummy.html#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> aug_private, <span class="fu">aes</span>(<span class="at">x =</span> .std.resid)) <span class="sc">+</span></span>
<span id="cb183-11"><a href="dummy.html#cb183-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_confidence</span>(<span class="at">model =</span> <span class="st">&quot;normal&quot;</span>) <span class="sc">+</span></span>
<span id="cb183-12"><a href="dummy.html#cb183-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#c62f4b&quot;</span>) <span class="sc">+</span></span>
<span id="cb183-13"><a href="dummy.html#cb183-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb183-14"><a href="dummy.html#cb183-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Standardized residual&quot;</span>) <span class="sc">+</span></span>
<span id="cb183-15"><a href="dummy.html#cb183-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability density&quot;</span>)</span>
<span id="cb183-16"><a href="dummy.html#cb183-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-17"><a href="dummy.html#cb183-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot of the public schools&#39; standardized residuals</span></span>
<span id="cb183-18"><a href="dummy.html#cb183-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> aug_public, <span class="fu">aes</span>(<span class="at">x =</span> .std.resid)) <span class="sc">+</span></span>
<span id="cb183-19"><a href="dummy.html#cb183-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_confidence</span>(<span class="at">model =</span> <span class="st">&quot;normal&quot;</span>) <span class="sc">+</span></span>
<span id="cb183-20"><a href="dummy.html#cb183-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#c62f4b&quot;</span>) <span class="sc">+</span></span>
<span id="cb183-21"><a href="dummy.html#cb183-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb183-22"><a href="dummy.html#cb183-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Standardized residual&quot;</span>) <span class="sc">+</span></span>
<span id="cb183-23"><a href="dummy.html#cb183-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability density&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-169"></span>
<img src="Modeling-in-Education_files/figure-html/unnamed-chunk-169-1.png" alt="Density plot of the standardized residuals from the regression model using educational sector to predict variation in six-year graduation rates for  private (LEFT) and public (RIGHT) colleges and universities (raspberry line). The sampling uncertainty associated with the normal distribution is also displayed (blue shaded area) for both sets of schools." width="45%" /><img src="Modeling-in-Education_files/figure-html/unnamed-chunk-169-2.png" alt="Density plot of the standardized residuals from the regression model using educational sector to predict variation in six-year graduation rates for  private (LEFT) and public (RIGHT) colleges and universities (raspberry line). The sampling uncertainty associated with the normal distribution is also displayed (blue shaded area) for both sets of schools." width="45%" />
<p class="caption">
Figure 66: Density plot of the standardized residuals from the regression model using educational sector to predict variation in six-year graduation rates for private (LEFT) and public (RIGHT) colleges and universities (raspberry line). The sampling uncertainty associated with the normal distribution is also displayed (blue shaded area) for both sets of schools.
</p>
</div>
<p>The normality assumption seems tenable since neither <em>conditional</em> distribution of residuals seem to indicate more mis-fit to normality than would be expected from sampling error. Lastly, we wonder if the independence assumption is tenable. It might seem reasonable that there is some dependence among graduation rates given that multiple schools may be related to one another (e.g., University of Minnesota–Twin Cities and Duluth). Dependence also arises because of spatial proximity. Since schools are located in particular geographic areas within Minnesota, thi might also be a problem.</p>
<p><br /></p>
</div>
<div id="including-other-predictors" class="section level2">
<h2>Including Other Predictors</h2>
<p>Based on the results from fitting the simple regression model, there seems to be differences between the average graduation rate between public and private institutions. It may, however, be that the private schools are just more selective and this selectivity is the cause of the differences in graduation rates. To examine this, we will include the median SAT score (<code>sat</code>) as a covariate into our model. So now, the regression model will include both the <code>public</code> dummy coded predictor and the <code>sat</code> predictors in an effort to explain variation in graduation rates.</p>
<p>Prior to fitting the regression model, we will examine the correlation matrix.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="dummy.html#cb184-1" aria-hidden="true" tabindex="-1"></a>mn <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="dummy.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(grad, private, sat) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="dummy.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="dummy.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fashion</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>     term  grad private   sat
1    grad          .397  .889
2 private  .397          .194
3     sat  .889    .194      </code></pre>
<p>From the correlation matrix we see:</p>
<ul>
<li>Private institutions tend to have higher graduation rates than public institutions (<span class="math inline">\(r = 0.397\)</span>).</li>
<li>Institutions with higher median SAT scores tend to have higher graduation rates (<span class="math inline">\(r=0.889\)</span>).</li>
<li>Private institutions tend to have higher median SAT scores than public institutions (<span class="math inline">\(r = 0.194\)</span>).</li>
</ul>
<p>Fitting the regeression model</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="dummy.html#cb186-1" aria-hidden="true" tabindex="-1"></a>lm.e <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sat <span class="sc">+</span> private, <span class="at">data =</span> mn)</span>
<span id="cb186-2"><a href="dummy.html#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="dummy.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb186-4"><a href="dummy.html#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">glance</span>(lm.e), <span class="at">width =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.843         0.832  6.86      80.3 9.05e-13     2  -109.  226.  232.
  deviance df.residual  nobs
     &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;
1    1411.          30    33</code></pre>
<p>Differences in educational sector and median SAT score explain 84.26% of the variation in graduation rates. This is statistically reliable, <span class="math inline">\(F(2, 30) = 80.27\)</span>, <span class="math inline">\(p&lt;0.001\)</span>.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="dummy.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb188-2"><a href="dummy.html#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.e)</span></code></pre></div>
<pre><code># A tibble: 3 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  -84.4     12.1        -7.00 8.76e- 8
2 sat            0.127    0.0111     11.4  1.88e-12
3 private        8.38     2.65        3.16 3.55e- 3</code></pre>
<p>The fitted equation is:</p>
<p><span class="math display">\[
\hat{\mathrm{Graduation~Rate}_i} = -84.4 + 0.13(\mathrm{SAT}_i) + 8.4(\mathrm{Private_i})
\]</span></p>
<p>Interpreting the coefficients,</p>
<ul>
<li>The average graduation rate for private schools that have a median SAT score of 0 is <span class="math inline">\(-84.4\)</span>%. (extrapolation)</li>
<li>A ten-point difference in median SAT score is associated with a 1.3 percentage point difference in graduation rate, controlling for differences in educational sector. (Here we interpret using a factor of 10.)</li>
<li>Private schools, on average, have a graduation rate that is 8.4 percentage points higher than public schools (reference group), controlling for differences in median SAT scores.</li>
</ul>
<p>Based on our research question, the focal predictor in this model is the coefficient and test associated with <code>private</code>. The <span class="math inline">\(t\)</span>-test associated with the partial slope for <code>private</code> suggests that the <em>controlled difference</em> in means between private and public schools is likely not 0 (<span class="math inline">\(p=0.004\)</span>) given the empirical evidence. Thus, even after controlling for differences in institution selectivity, we believe there is still a difference in private and public schools’ graduation rates, on average.</p>
<p><br /></p>
<div id="analysis-of-covariance-ancova" class="section level3">
<h3>Analysis of Covariance (ANCOVA)</h3>
<p>Our research question in the controlled model, fundamentally, is: <em>Is there a difference on Y between group A and group B, after controlling for covariate Z?</em> We can make the question more complex by having more than two groups (say group A, group B, and group C), or by controlling for multiple covariates. But, the primary question is whether there are group differences on some outcome after controlling for one or more covariates.</p>
<p>In the social sciences, the methodology used to analyze group differences when controlling for other predictors is referred to as <em>analysis of covariance</em>, or ANCOVA. ANCOVA models can be analyzed using a framework that focuses on partitioning variation (ANOVA) or using regression as a framework. Both ultimately give the same results (<span class="math inline">\(p\)</span>-values, etc.). In this course we will focus using the regression framework to analyze this type of data.</p>
<p><br /></p>
</div>
<div id="adjusted-means" class="section level3">
<h3>Adjusted Means</h3>
<p>Since the focus of the analysis is to answer whether there is a difference in graduation rates between private and public schools, we should provide some measure of how different the graduation rates are. Initially, we provided the mean graduation rates for public and private schools, along with the difference in these two means. These are referred to as the <em>unconditional means</em> and the <em>unconditional mean difference</em>, respectively. They are unconditional because they are the model predicted means (<span class="math inline">\(\hat{Y_i}\)</span>-values) from the model that does not include any covariates.</p>
<p>After fitting our controlled model, we should provide new <em>adjusted means</em> and an <em>adjusted mean difference</em> based on the predicted mean graduation rates from the model that controls for median SAT scores. Typically, the adjusted means are computed based on substituting in the mean value for all covariates, and then computing the predicted value for all groups. Here we show those computations for our analysis.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="dummy.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean SAT</span></span>
<span id="cb190-2"><a href="dummy.html#cb190-2" aria-hidden="true" tabindex="-1"></a>mn <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="dummy.html#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">M =</span> <span class="fu">mean</span>(sat))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
      M
  &lt;dbl&gt;
1 1101.</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="dummy.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute adjusted mean for private schools</span></span>
<span id="cb192-2"><a href="dummy.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">84.4</span> <span class="sc">+</span> <span class="fl">0.127</span><span class="sc">*</span><span class="fl">1101.2</span> <span class="sc">+</span> <span class="fl">8.4</span><span class="sc">*</span><span class="dv">1</span></span></code></pre></div>
<pre><code>[1] 63.8524</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="dummy.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute adjusted mean for public schools</span></span>
<span id="cb194-2"><a href="dummy.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">84.4</span> <span class="sc">+</span> <span class="fl">0.127</span><span class="sc">*</span><span class="fl">1101.2</span> <span class="sc">+</span> <span class="fl">8.4</span><span class="sc">*</span><span class="dv">0</span></span></code></pre></div>
<pre><code>[1] 55.4524</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="dummy.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute adjusted mean difference</span></span>
<span id="cb196-2"><a href="dummy.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fl">63.9</span> <span class="sc">-</span> <span class="fl">55.5</span></span></code></pre></div>
<pre><code>[1] 8.4</code></pre>
<p>Note that the adjusted mean difference is the value of the partial regression coefficient for <code>private</code> from the ANCOVA model. These values are typically presented in a table along with the unadjusted values.</p>
<table style="width:60%; margin-left: auto; margin-right: auto;border-bottom: 0;" class="table">
<caption>
<span id="tab:unnamed-chunk-174">Table 15: </span>Unadjusted and adjusted mean six-year graduation rates for private and public colleges and universities in Minnesota.
</caption>
<thead>
<tr>
<th style="text-align:left;text-align: center;">
</th>
<th style="text-align:center;text-align: center;">
Unadjusted Mean
</th>
<th style="text-align:center;text-align: center;">
Adjusted Mean<sup>a</sup>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Private institution
</td>
<td style="text-align:center;">
65.3
</td>
<td style="text-align:center;">
63.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Public institution
</td>
<td style="text-align:center;">
51.0
</td>
<td style="text-align:center;">
55.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Difference
</td>
<td style="text-align:center;">
14.3
</td>
<td style="text-align:center;">
8.4
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<sup>a</sup> Model controlled for median SAT scores
</td>
</tr>
</tfoot>
</table>
<p><br /></p>
</div>
</div>
<div id="one-last-model" class="section level2">
<h2>One Last Model</h2>
<p>Now we will include the <code>private</code> dummy coded predictor, the <code>sat</code> predictor, and the <code>tuition</code> predictor in a model to explain variation in graduation rates. Our focus again will be on whether or not there are mean differences in graduation rates between public and private schools, but this time after controlling for differences in median SAT scores and tuition.</p>
<p>Again, prior to fitting the regression model, we will examine the correlation matrix.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="dummy.html#cb198-1" aria-hidden="true" tabindex="-1"></a>mn <span class="sc">%&gt;%</span></span>
<span id="cb198-2"><a href="dummy.html#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(grad, private, sat, tuition) <span class="sc">%&gt;%</span></span>
<span id="cb198-3"><a href="dummy.html#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb198-4"><a href="dummy.html#cb198-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fashion</span>(<span class="at">decimals =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>     term  grad private   sat tuition
1    grad          .397  .889    .755
2 private  .397          .194    .773
3     sat  .889    .194          .613
4 tuition  .755    .773  .613        </code></pre>
<p>From the correlation matrix we see:</p>
<ul>
<li>Private institutions tend to have higher graduation rates than public institutions (<span class="math inline">\(r = 0.397\)</span>).</li>
<li>Institutions with higher median SAT scores tend to have higher graduation rates (<span class="math inline">\(r=0.889\)</span>).</li>
<li>Institutions with higher tuition costs tend to have higher graduation rates (<span class="math inline">\(r=0.755\)</span>).</li>
<li>Private institutions tend to have higher median SAT scores than public institutions (<span class="math inline">\(r = 0.194\)</span>).</li>
<li>Private institutions tend to have higher tuition costs than public institutions (<span class="math inline">\(r = 0.773\)</span>).</li>
<li>Institutions with higher tuition costs tend to have higher median SAT scores (<span class="math inline">\(r=0.613\)</span>).</li>
</ul>
<p>Fitting the regression model:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="dummy.html#cb200-1" aria-hidden="true" tabindex="-1"></a>lm.f <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sat <span class="sc">+</span> tuition <span class="sc">+</span> private, <span class="at">data =</span> mn)</span>
<span id="cb200-2"><a href="dummy.html#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="dummy.html#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level info</span></span>
<span id="cb200-4"><a href="dummy.html#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.f)</span></code></pre></div>
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squa…¹ sigma stati…²  p.value    df logLik   AIC   BIC devia…³
      &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1     0.861        0.846  6.56    59.7 1.59e-12     3  -107.  224.  231.   1249.
# … with 2 more variables: df.residual &lt;int&gt;, nobs &lt;int&gt;, and abbreviated
#   variable names ¹​adj.r.squared, ²​statistic, ³​deviance
# ℹ Use `colnames()` to see all variable names</code></pre>
<p>Differences in median SAT scores, tuition rates, and educational sector explain 86.07% of the variation in graduation rates. This is statistically reliable, <span class="math inline">\(F(3, 29) = 59.73\)</span>, <span class="math inline">\(p&lt;0.001\)</span>.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="dummy.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level info</span></span>
<span id="cb202-2"><a href="dummy.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.f)</span></code></pre></div>
<pre><code># A tibble: 4 × 5
  term        estimate std.error statistic     p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 (Intercept)  -68.9     14.0       -4.92  0.0000318  
2 sat            0.104    0.0159     6.54  0.000000364
3 tuition        0.470    0.242      1.94  0.0617     
4 private        0.647    4.72       0.137 0.892      </code></pre>
<p>Here we will not interpret all of the coefficients, but instead focus on only the <code>private</code> coefficient, as that is germain to our research question.</p>
<ul>
<li>Private schools, on average, have a graduation rate that is 0.64 percentage points higher than public schools, controlling for differences in median SAT scores and tuition.</li>
</ul>
<p>The <span class="math inline">\(t\)</span>-test associated with the partial slope coefficient for <code>private</code> suggests that 0 is a possible value for the <em>controlled difference</em> in means between private and public schools (<span class="math inline">\(p=0.892\)</span>). Given the empirical evidence, after controlling for differences in median SAT score and tuition rates, it is uncertain that there is a difference in average graduation rates between private and public schools.</p>
<p><br /></p>
</div>
<div id="assumption-checking-for-the-final-model" class="section level2">
<h2>Assumption Checking for the Final Model</h2>
<p>It is important to check the assumptions of any adopted model. Since we have added non-categorical covariates into the model we need to evaluate all four major assumptions (LINE).</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="dummy.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the fitted values and residuals</span></span>
<span id="cb204-2"><a href="dummy.html#cb204-2" aria-hidden="true" tabindex="-1"></a>aug_f <span class="ot">=</span> <span class="fu">augment</span>(lm.f)</span>
<span id="cb204-3"><a href="dummy.html#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="dummy.html#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View augmented data frame</span></span>
<span id="cb204-5"><a href="dummy.html#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aug_f)</span></code></pre></div>
<pre><code># A tibble: 6 × 10
   grad   sat tuition private .fitted .resid   .hat .sigma .cooksd .std.resid
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
1  65.2  1030    39.3       1    57.1   8.14 0.104    6.48 0.0497       1.31 
2  52.6  1065    30.5       1    56.6  -3.96 0.0839   6.63 0.00908     -0.630
3  73.3  1145    39.4       1    69.0   4.25 0.0458   6.63 0.00528      0.663
4  92.6  1400    54.3       1   102.   -9.90 0.264    6.31 0.276       -1.76 
5  81.1  1185    43.2       1    75.0   6.12 0.0609   6.57 0.0150       0.962
6  69.4  1145    36.6       1    67.7   1.67 0.0563   6.67 0.00103      0.262</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="dummy.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot of the marginal standardized residuals</span></span>
<span id="cb206-2"><a href="dummy.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> aug_f, <span class="fu">aes</span>(<span class="at">x =</span> .std.resid)) <span class="sc">+</span></span>
<span id="cb206-3"><a href="dummy.html#cb206-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_confidence</span>(<span class="at">model =</span><span class="st">&quot;normal&quot;</span>) <span class="sc">+</span></span>
<span id="cb206-4"><a href="dummy.html#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#c62f4b&quot;</span>) <span class="sc">+</span></span>
<span id="cb206-5"><a href="dummy.html#cb206-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb206-6"><a href="dummy.html#cb206-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Standardized residual&quot;</span>) <span class="sc">+</span></span>
<span id="cb206-7"><a href="dummy.html#cb206-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability density&quot;</span>)</span>
<span id="cb206-8"><a href="dummy.html#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="dummy.html#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot of the standardized residuals versus the fitted values</span></span>
<span id="cb206-10"><a href="dummy.html#cb206-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> aug_f, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .std.resid)) <span class="sc">+</span></span>
<span id="cb206-11"><a href="dummy.html#cb206-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb206-12"><a href="dummy.html#cb206-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb206-13"><a href="dummy.html#cb206-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb206-14"><a href="dummy.html#cb206-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Fitted value&quot;</span>) <span class="sc">+</span></span>
<span id="cb206-15"><a href="dummy.html#cb206-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Standardized residual&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-178"></span>
<img src="Modeling-in-Education_files/figure-html/unnamed-chunk-178-1.png" alt="LEFT: Density plot of the marginal distribution of standardized residuals from a regression model using median SAT score, tuition rates, and educational sector to predict variation in six-year graduation rates (raspberry line). The sampling uncertainty associated with the normal distribution is also displayed (blue shaded area). RIGHT: Scatterplot of the standardized residuals versus the fitted values from the same model. A horizontal line at $Y=0$ shows the expected mean residual under the linearity assumption. The loess line (blue) and uncertainty bands (grey shaded area) are also displayed." width="45%" /><img src="Modeling-in-Education_files/figure-html/unnamed-chunk-178-2.png" alt="LEFT: Density plot of the marginal distribution of standardized residuals from a regression model using median SAT score, tuition rates, and educational sector to predict variation in six-year graduation rates (raspberry line). The sampling uncertainty associated with the normal distribution is also displayed (blue shaded area). RIGHT: Scatterplot of the standardized residuals versus the fitted values from the same model. A horizontal line at $Y=0$ shows the expected mean residual under the linearity assumption. The loess line (blue) and uncertainty bands (grey shaded area) are also displayed." width="45%" />
<p class="caption">
Figure 67: LEFT: Density plot of the marginal distribution of standardized residuals from a regression model using median SAT score, tuition rates, and educational sector to predict variation in six-year graduation rates (raspberry line). The sampling uncertainty associated with the normal distribution is also displayed (blue shaded area). RIGHT: Scatterplot of the standardized residuals versus the fitted values from the same model. A horizontal line at <span class="math inline">\(Y=0\)</span> shows the expected mean residual under the linearity assumption. The loess line (blue) and uncertainty bands (grey shaded area) are also displayed.
</p>
</div>
<p>The marginal distribution of the residuals shows minor evidence of mis-fit with the normality assumption. The equal variances assumption looks tenable from this set of plots. However, the scatterplot of the standardized residuals versus the fitted values suggests problems with the tenability of the linearity assumption—at low fitted values more of the residuals are negative than we would expect (over-estimation); at moderate fitted values the residuals tend to be positive (under-estimation); and at high fitted values the residuals tend to the negative again (over-estimation). For now we will ignore this (although in practice this is a BIG problem).</p>
<p><br /></p>
</div>
<div id="presenting-results-1" class="section level2">
<h2>Presenting Results</h2>
<p>Below we present pertinent results from the three models that we fitted.</p>
<table class="table" style="width:70%; margin-left: auto; margin-right: auto; text-align:center">
<caption>
Unstandardized coefficients (standard errors) for a taxonomy of OLS regression models to explain variation in six-year graduation rates for colleges and universities in Minnesota. All models were fitted with <em>n</em>=33 observations.
</caption>
<thead>
<tr>
<th style="text-align:left">
</th>
<th>
Model A
</th>
<th>
Model B
</th>
<th>
Model C
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">
Median SAT score
</td>
<td>
</td>
<td>
0.127<br />(0.011)
</td>
<td>
0.104<br />(0.016)
</td>
</tr>
<tr>
<td style="text-align:left">
Tuition
</td>
<td>
</td>
<td>
</td>
<td>
0.470<br />(0.242)
</td>
</tr>
<tr>
<td style="text-align:left">
Educational Sector
</td>
<td>
14.235<br />(5.912)
</td>
<td>
8.378<br />(2.648)
</td>
<td>
0.647<br />(4.716)
</td>
</tr>
<tr style="border-bottom: 1px solid black">
<td style="text-align:left">
Constant
</td>
<td>
51.030<br />(4.936)
</td>
<td>
-84.435<br />(12.054)
</td>
<td>
-68.944<br />(14.017)
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.158
</td>
<td>
0.843
</td>
<td>
0.861
</td>
</tr>
<tr>
<td style="text-align:left">
RMSE
</td>
<td>
15.608
</td>
<td>
6.859
</td>
<td>
6.562
</td>
</tr>
<tr style="border-top: 1px solid black; border-bottom: 0">
<td style="text-align:left" colspan="4">
<em>Note: </em>Educational sector was dummy coded so that 0 = Private institutions; 1 = Public institutions.
</td>
</tr>
</tbody>
</table>
<p><br /></p>
<div id="data-narrative" class="section level3">
<h3>Data Narrative</h3>
<p>The presentation of the models help us build an evidence-based narrative about the differences in graduation rates between public and private schools. In the unconditional model, the evidence suggests that private schools have a higher graduation rate than public schools. Once we control for median SAT score, this difference in graduation rates persists, but at a much lesser magnitude. Finally, after controlling for differences in SAT scores and tuition, we find no statistically reliable differences between the two educational sectors.</p>
<p>This narrative suggests that the initial differences we saw in graduation rates between the two sectors is really just a function of differences in SAT scores and tuition, and not really a public/private school difference. As with many non-experimental results, the answer to the question about group differences change as we control for different covariates. It may be, that once we control for other covariates, the narrative might change yet again. This is an important lesson, and one that cannot be emphasized enough—the magnitude and statistical importance of predictors change when the model is changed.</p>
<p><br /></p>
</div>
<div id="plots-to-display-model-results" class="section level3">
<h3>Plots to Display Model Results</h3>
<p>There are two plots we may want to consider creating to accompany the data narrative: (1) a coefficient plot to emphasize the public–private institution difference (i.e., effect of educational sector), and (2) a plot of the final fitted model, again emphasizing the public–private institution difference. We start by creating the coefficient plot.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="dummy.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb207-2"><a href="dummy.html#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dotwhisker)</span>
<span id="cb207-3"><a href="dummy.html#cb207-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-4"><a href="dummy.html#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create tidy() objects and identify each with a model column</span></span>
<span id="cb207-5"><a href="dummy.html#cb207-5" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">tidy</span>(lm.c) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;Model A&quot;</span>)</span>
<span id="cb207-6"><a href="dummy.html#cb207-6" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">tidy</span>(lm.e) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;Model B&quot;</span>)</span>
<span id="cb207-7"><a href="dummy.html#cb207-7" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">=</span> <span class="fu">tidy</span>(lm.f) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;Model C&quot;</span>)</span>
<span id="cb207-8"><a href="dummy.html#cb207-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-9"><a href="dummy.html#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all three tidy() outputs, filter out intercepts, and drop missing values</span></span>
<span id="cb207-10"><a href="dummy.html#cb207-10" aria-hidden="true" tabindex="-1"></a>all_models <span class="ot">=</span> <span class="fu">rbind</span>(m1, m2, m3)</span>
<span id="cb207-11"><a href="dummy.html#cb207-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-12"><a href="dummy.html#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb207-13"><a href="dummy.html#cb207-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dwplot</span>(all_models, <span class="at">show_intercept =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb207-14"><a href="dummy.html#cb207-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb207-15"><a href="dummy.html#cb207-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Model&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#c62f4b&quot;</span>, <span class="st">&quot;#c62f4b&quot;</span>, <span class="st">&quot;#c62f4b&quot;</span>)) <span class="sc">+</span></span>
<span id="cb207-16"><a href="dummy.html#cb207-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb207-17"><a href="dummy.html#cb207-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(</span>
<span id="cb207-18"><a href="dummy.html#cb207-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">&quot;Coefficients&quot;</span>, </span>
<span id="cb207-19"><a href="dummy.html#cb207-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Tuition&quot;</span>, <span class="st">&quot;Median SAT score&quot;</span>, <span class="st">&quot;Private institution</span><span class="sc">\n</span><span class="st">(dummy coded)&quot;</span>)</span>
<span id="cb207-20"><a href="dummy.html#cb207-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb207-21"><a href="dummy.html#cb207-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb207-22"><a href="dummy.html#cb207-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>model)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-180"></span>
<img src="Modeling-in-Education_files/figure-html/unnamed-chunk-180-1.png" alt="Coefficient plot for three models regressing six-year graduation rates on educational sector. Uncertainty based on the 95% confidence intervals is displayed. (The intercept is not displayed.)" width="90%" />
<p class="caption">
Figure 68: Coefficient plot for three models regressing six-year graduation rates on educational sector. Uncertainty based on the 95% confidence intervals is displayed. (The intercept is not displayed.)
</p>
</div>
<p>A second plot is based on plotting the model predicted graduation rates as a function of one of the predictors. Here we will plot the model predicted graduation rates as a function of median SAT scores for both public and private institutions. We will control for tuition rate by fixing it to its mean value of 32.25. Substituting this into the fitted equation, along with the appropriate dummy-coded public value results in two equations that we can plot.</p>
<p><span class="math display">\[
\begin{split}
\mathbf{Public:}\quad\hat{\mathrm{Graduation~Rate}_i} &amp;= -68.9 + 0.10(\mathrm{Median~SAT}_i) + 0.47(32.25) + 0.65(0) \\[2ex]
&amp;= -53.7 + 0.10(\mathrm{Median~SAT}_i) \\[4ex]
\mathbf{Private:}\quad\hat{\mathrm{Graduation~Rate}_i} &amp;= -68.9 + 0.10(\mathrm{Median~SAT}_i) + 0.47(32.25) + 0.65(1)\\[2ex]
&amp;= -53.0 + 0.10(\mathrm{Median~SAT}_i)
\end{split}
\]</span></p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="dummy.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> sat, <span class="at">y =</span> grad)) <span class="sc">+</span></span>
<span id="cb208-2"><a href="dummy.html#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb208-3"><a href="dummy.html#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="fl">53.7</span>, <span class="at">slope =</span> <span class="fl">0.10</span>, <span class="at">color =</span> <span class="st">&quot;#e69f00&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span></span>
<span id="cb208-4"><a href="dummy.html#cb208-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="fl">53.0</span>, <span class="at">slope =</span> <span class="fl">0.10</span>, <span class="at">color =</span> <span class="st">&quot;#56b4e9&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb208-5"><a href="dummy.html#cb208-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb208-6"><a href="dummy.html#cb208-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Median SAT score&quot;</span>) <span class="sc">+</span></span>
<span id="cb208-7"><a href="dummy.html#cb208-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Predicted graduation rate&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-181"></span>
<img src="Modeling-in-Education_files/figure-html/unnamed-chunk-181-1.png" alt="Predicted graduation rate as a function of median SAT scores for public (orange, solid line) and private (blue, dashed line) institutions in Minnesota. Tuition rate is controlled for by fixing the value to the marginal average tuition value." width="50%" />
<p class="caption">
Figure 69: Predicted graduation rate as a function of median SAT scores for public (orange, solid line) and private (blue, dashed line) institutions in Minnesota. Tuition rate is controlled for by fixing the value to the marginal average tuition value.
</p>
</div>
<p>In my opinion, the coefficient plot corresponds better to the data narrative than the plot of the fitted model, so in a publication that is what I would present along with the table of model results.</p>

</div>
</div>
</div>
<p style="text-align: center;">
<a href="assumptions.html"><button class="btn btn-default">Previous</button></a>
<a href="polychotomous.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
