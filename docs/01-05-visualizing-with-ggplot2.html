<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Visualizing Data with ggplot2 – Statistical Modeling and Computation for Educational Scientists</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-732fb9ccd080a018ca85ca5d15770f52.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-44b64cbf1a1a4e5718d81f3787ba6ba1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/sticky-notes.css">
<link rel="stylesheet" href="assets/table-styles.css">
</head>

<body class="nav-sidebar floating fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title"><span id="ggplot2" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualizing Data with ggplot2</span></span></h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Modeling and Computation for Educational Scientists</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Front Matter</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01-00-statistical-computation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Statistical Computation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-01-r-and-rstudio-installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R and RStudio: Installation and Setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-02-getting-started-with-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Started with R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-03-data-structures-in-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Structures in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-04-data-wrangling-with-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Wrangling with dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-05-visualizing-with-ggplot2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualizing Data with ggplot2</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-00-intro-to-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-01-data-exploration-for-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Exploration for Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-02-simple-regression-and-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Simple Linear Regression and Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-03-ols-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ordinary Least Squares (OLS) Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-04-anova-decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">ANOVA Decomposition and <span class="math inline">\(R^2\)</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-05-standardized-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Standardized Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03-00-regression-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-01-coefficient-level-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Coefficient-Level Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-02-model-level-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model-Level Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-03-model-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Assumptions Underlying the Regression Model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04-00-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-01-intro-to-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduction to Multiple Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-02-multiple-regression-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multiple Regression: ANOVA Decomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-03-understanding-statistical-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Understanding Statistical Control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-04-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Assumptions: Multiple Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./05-00-categorical-predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Categorical Predictors</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-01-dichotomous-predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Dichotomous Categorical Predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-02-polychotomous-predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Polychotomous Categorical Predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-03-multiple-comparisons.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Multiple Comparisons</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./06-00-interaction-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interaction Effects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-01-intro-to-interaction-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction to Interaction Effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-02-more-interaction-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">More Interaction Effects</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-00-data-codebooks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Dictionaries</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span id="ggplot2" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualizing Data with ggplot2</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter, you will be learn about how to use functionality from the <code>{ggplot2}</code> package to visualize your data. Data visualization helps you identify trends in your data. It can also help you find unexpected observations or patterns you might miss in the raw numbers themselves. Visualization is an important step in almost every data analysis and is often all you need to draw meaningful conclusions about the data!</p>
<p>We will use the <strong>gapminder.csv</strong> data to illustrate how to create and modify visualizations using functionality in <code>{ggplot2}</code>.</p>
<p>To begin, we will load the <code>{dplyr}</code>, <code>{ggplot2}</code> and <code>{readr}</code> libraries, and import the data into an object called <code>gapminder</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/modeling/main/data/gapminder.csv"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gapminder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 193
Columns: 8
$ country      &lt;chr&gt; "Afghanistan", "Albania", "Algeria", "Andorra",…
$ region       &lt;chr&gt; "Asia", "Europe", "Africa", "Europe", "Africa",…
$ income       &lt;dbl&gt; 2.03, 13.30, 11.60, 58.30, 6.93, 21.00, 22.70, …
$ income_level &lt;chr&gt; "Level 1", "Level 3", "Level 3", "Level 4", "Le…
$ life_exp     &lt;dbl&gt; 62.7, 78.4, 76.0, 82.1, 64.6, 76.2, 76.5, 75.6,…
$ co2          &lt;dbl&gt; 0.254, 1.590, 3.690, 6.120, 1.120, 5.880, 4.410…
$ co2_change   &lt;chr&gt; "increase", "increase", "increase", "decrease",…
$ population   &lt;dbl&gt; 37.2000, 2.8800, 42.2000, 0.0770, 30.8000, 0.09…</code></pre>
</div>
</div>
<p><br></p>
<section id="some-background" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="some-background"><span class="header-section-number">5.1</span> Some Background</h2>
<p>The <code>gg</code> in <code>{ggplot2</code>} stands for <em>grammar of graphics</em>. The grammar of graphics <span class="citation" data-cites="wilkinson:2005">(<a href="#ref-wilkinson:2005" role="doc-biblioref">Wilkinson, 2005</a>)</span> is a formal system of expressive grammatical rules for creating perceivable graphs. The grammar of graphics includes things such as aesthetics, geometries, scales, facets, and guides. Hadley Wickham adopted this grammar into the initial <code>{ggplot}</code> package, which he then re-wrote and updated to create the <code>{ggplot2}</code> package. As you learn how to create plots using <code>{ggplot2}</code>, you will also begin to learn the grammar of graphics. Understanding this grammar will help you describe, and create almost any visualization you can imagine.</p>
<p><br></p>
</section>
<section id="understanding-the-basic-syntax" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="understanding-the-basic-syntax"><span class="header-section-number">5.2</span> Understanding the Basic Syntax</h2>
<p>Plots in <code>{ggplot2</code>} are built by <em>layering</em> different components. For example, consider the following syntax which creates a scatterplot using the income and CO2 emissions attributes:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-understand" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Scatterplot of CO2 emissions versus income.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-understand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Scatterplot of CO2 emissions versus income.
</figcaption>
<div aria-describedby="fig-understand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-understand-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Scatterplot of CO2 emissions versus income.">
</div>
</figure>
</div>
</div>
</div>
<p>In this syntax there are three layers used to create the plot:</p>
<ol type="1">
<li>a global layer,</li>
<li>a geometric layer, and</li>
<li>a theme layer.</li>
</ol>
<p>The layers are literally <em>summed</em> together to form the plot. We will look at each of these layers in turn.</p>
<p><br></p>
<section id="the-global-layer" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="the-global-layer"><span class="header-section-number">5.2.1</span> The Global Layer</h3>
<p>The first layer (referred to as the global layer) in every plot you create employs the function <code>ggplot()</code>. It contains a reference to the source data (<code>data=</code>) and any <em>global aesthetic mappings</em> (more about this later). The first layer only sets up the plot, it doesn’t actually plot anything.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-global" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="The background layer for the plot is drawn. The domain (x-values) and range (y-values) is based on data in the income and co2 attributes.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-global-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: The background layer for the plot is drawn. The domain (x-values) and range (y-values) is based on data in the income and co2 attributes.
</figcaption>
<div aria-describedby="fig-global-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-global-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="The background layer for the plot is drawn. The domain (x-values) and range (y-values) is based on data in the income and co2 attributes.">
</div>
</figure>
</div>
</div>
</div>
<ul>
<li>The <code>data=</code> argument indicates the source data frame.</li>
<li>The <code>aes=</code> argument sets the aesthetic mapping(s).</li>
</ul>
<p><br></p>
</section>
<section id="aesthetics-and-aesthetic-mappings" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="aesthetics-and-aesthetic-mappings"><span class="header-section-number">5.2.2</span> Aesthetics and Aesthetic Mappings</h3>
<p>Aesthetics define what we, as humans, perceive in a given plot; that is the visual properties of a plot. For example, the position of certain elements in the plot (where they are located), or the color or transparency of an element. These aesthetics can be fixed or variable. For example, consider the color of a set of points. If the color is fixed, it would be the same for all the points. If the color is variable, it might be red for some points and blue for other points. Often, this variability in the aesthetic is based on some attribute in our dataset (e.g., points representing Democrats are colored blue, while those representing Republicans are colored red).</p>
<p>Linking an aesthetic to an attribute in the data, is referred to as an <em>aesthetic mapping</em>. That is because aesthetic mappings map visual properties in the plot (e.g., position, color) to the values in a particular attributes in the data. Aesthetic mappings are specified in an <code>aes()</code> function. In our earlier example syntax, there were two aesthetic mappings that were defined:</p>
<ol type="1">
<li>Income values from the data will be mapped to the <em>x</em>-position.</li>
<li>CO2 values from the data will be mapped to the <em>y</em>-position.</li>
</ol>
<p>These mappings were used to define the domain (<em>x</em>-values) and range (<em>y</em>-values) for the blank plot created by the <code>ggplot()</code> global layer.</p>
<div class="protip">
<p><strong>IMPORTANT</strong></p>
<p>All aesthetic mappings need to be specified in an <code>aes()</code> function. Because aesthetic mappings use information in the attribute to apply the specified visual properties, the aesthetics (e.g., <code>x=</code>, <code>y=</code>, <code>color=</code>) need to be set to an attribute name in the data frame. For example, both <code>income</code> and <code>co2</code> are attribute names in the <code>gapminder</code> data object.</p>
</div>
<p><br></p>
</section>
<section id="adding-layers" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="adding-layers"><span class="header-section-number">5.2.3</span> Adding Layers</h3>
<p>After starting with the global layer, we can modify our visualization by adding layers to the global layer. For example, the layer that includes the function <code>geom_point()</code> is being added to the global layer in the syntax below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-adding" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Points are added on top of the plot's background layer.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-adding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Points are added on top of the plot’s background layer.
</figcaption>
<div aria-describedby="fig-adding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-adding-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Points are added on top of the plot's background layer.">
</div>
</figure>
</div>
</div>
</div>
<p>Geometric layers (<code>geom_*</code>) are used to add things like points, lines, histograms, densities, etc. The <code>geom_point()</code> layer in our plot is actually drawing the points of the scatter plot. These layers draw on the aesthetic mappings defined in the global layer to know where to draw these geometric objects. For example, the data in the <code>income</code> and <code>co2</code> variables define the <em>x</em>- and <em>y</em>-positions of the points, respectively.</p>
<p>When layers are added they are “stacked” on top of previous layers. For example, consider the two sets of syntax below. Each will again create our scatterplot by adding a set of points based on the data in the global layer. Each will also draw a loess smoother (a sort of trend line). However, in the first set of syntax, the smoother is drawn on top of the points, and in the second set of syntax, the points are drawn on top of the loess smoother. (The argument <code>alpha=1</code> sets the transparency of the smoother to be completely opaque.)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LEFT: Draw smoother on top of points</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">alpha =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RIGHT: Draw points on top of smoother</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-layer" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="LEFT: The smoother is drawn on top of the points. RIGHT: The points are drawn on top of the smoother.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-layer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: LEFT: The smoother is drawn on top of the points. RIGHT: The points are drawn on top of the smoother.
</figcaption>
<div aria-describedby="fig-layer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-layer-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="LEFT: The smoother is drawn on top of the points. RIGHT: The points are drawn on top of the smoother.">
</div>
</figure>
</div>
</div>
</div>
<p>A useful metaphor might be to imagine putting together a collage of many different photographs. Some parts of some of the photographs (especially those you put down first) might be covered up by photographs that you add later.</p>
<div class="protip">
<p><strong>PROTIP</strong></p>
<p>When you are creating plots, you might need to switch the order of some of the layers to get the visualization you want.</p>
</div>
<p><br></p>
</section>
<section id="good-syntactic-habits" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="good-syntactic-habits"><span class="header-section-number">5.2.4</span> Good Syntactic Habits</h3>
<p>As we add multiple layers to build up our plot, it is a good habit to use multiple lines for the syntax. Generally we put one layer on each line.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>+</code> sign needs to be at the end of the line (not at the beginning). If you are using a script file (which you should be), highlight ALL layers in the plot and click <code>Run</code> to create the plot.</p>
<div class="protip">
<p><strong>PROTIP</strong></p>
<p>If you write your <code>{ggplot2}</code> syntax across multiple lines, it makes it not only easier to read, but also easier to try out different layers or features. For example, you can comment out lines to remove layers as you are building the plot without losing the syntax you wrote.</p>
<p>You can also debug syntax by highlighting all lines up to a given <code>+</code> sign and running the syntax. By subsequently highlighting and running additional lines of syntax, you can often figure out where any errors show up!</p>
</div>
<p><br></p>
</section>
</section>
<section id="global-vs.-local-aesthetic-mappings" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="global-vs.-local-aesthetic-mappings"><span class="header-section-number">5.3</span> Global vs.&nbsp;Local Aesthetic Mappings</h2>
<p>As you learned earlier, we use the <code>aes()</code> function to set aesthetic mappings (i.e., linking attributes to aesthetics). Aesthetic mappings are often set globally (in the initial <code>ggplot()</code> layer). When we include aesthetic mappings in the global layer they are applied to <em>all layers</em> in the plot. For example, the syntax below maps data in the <code>income</code> attribute to the <em>x</em>-position, data from the <code>co2</code> attribute to the <em>y</em>-position, and data from the <code>region</code> attribute to color for both the loess smoother and the points.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All aesthetic mappings are global</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2, <span class="at">color =</span> region)) <span class="sc">+</span>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aes" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="The global aesthetic mappings of x- and y-positioning, as well as, color are applied to the smoother and point layers.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-aes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: The global aesthetic mappings of x- and y-positioning, as well as, color are applied to the smoother and point layers.
</figcaption>
<div aria-describedby="fig-aes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-aes-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="The global aesthetic mappings of x- and y-positioning, as well as, color are applied to the smoother and point layers.">
</div>
</figure>
</div>
</div>
</div>
<div class="protip">
<p><strong>FYI</strong></p>
<p>Notice when we use non-positional aesthetic mappings (e.g., color) a legend, or guide in the grammar of graphics, will be automatically added to our plot for each aesthetic mapping.</p>
</div>
<p>Aesthetic mappings can also be set locally in a specific layer. Aesthetic mappings set in a specific layer only apply to that particular layer. Below, we continue to globally map data from the <code>income</code> attribute to the <em>x</em>-position, and data from the <code>co2</code> attribute to the <em>y</em>-position. Both the smoother layer and point layer will utilize that. However, only the point layer will map data from the <code>region</code> attribute to color. Note that regardless of whether the aesthetic mapping is global or local, we still make this mapping inside an <code>aes()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aesthetic mappings for x- and y-position are global</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Aesthetic mapping for color only applies to the points layer</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> region))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aes2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="The global aesthetic mappings of x- and y-positioning are applied to the smoother and point layers. The aesthetic mapping of color is only applied to the point layer.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-aes2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6: The global aesthetic mappings of x- and y-positioning are applied to the smoother and point layers. The aesthetic mapping of color is only applied to the point layer.
</figcaption>
<div aria-describedby="fig-aes2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-aes2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="The global aesthetic mappings of x- and y-positioning are applied to the smoother and point layers. The aesthetic mapping of color is only applied to the point layer.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="fixed-aesthetics" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="fixed-aesthetics"><span class="header-section-number">5.4</span> Fixed Aesthetics</h2>
<p>Fixed aesthetics assign the exact same value for the visual property for <strong>all</strong> the observations; it is not based on the data. Fixed aesthetics do not go inside of the <code>aes()</code> function. (Remember: Inside of the <code>aes()</code> function the mapping has to be to an attribute name!) The following syntax uses the following aesthetics:</p>
<ul>
<li><strong>Global aesthetic mapping:</strong> Data from the <code>income</code> attribute mapped to the <em>x</em>-position.</li>
<li><strong>Global aesthetic mapping:</strong> Data from the <code>co2</code> attribute mapped to the <em>y</em>-position.</li>
<li><strong>Fixed local aesthetic:</strong> All points are given a shape of <code>22</code> (filled square with a border). You can see all the shape options <a href="http://www.sthda.com/english/wiki/ggplot2-point-shapes">here</a>.</li>
<li><strong>Fixed local aesthetic:</strong> All points are given a size of <code>4</code> (slightly bigger). The default size is 3.</li>
<li><strong>Local aesthetic mapping:</strong> Data from the <code>region</code> attribute mapped to fill for the points layer only. Because we are using a different shape we use <code>fill=</code> rather than <code>color=</code> to color the observations.</li>
<li><strong>Fixed local aesthetic:</strong> All points are given a border color of black (for this shape border color is set using <code>color=</code>).</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aesthetic mappings for x- and y-position are global</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Aesthetic mapping for fill only applies to the points layer</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># All points are the same shape, size, and border color</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> region), <span class="at">shape =</span> <span class="dv">22</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aes3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="The global aesthetic mappings of x- and y-positioning are applied to the smoother and point layers. The aesthetic mapping of color is only applied to the point layer. The point layer also includes several fixed aesthetics.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-aes3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.7: The global aesthetic mappings of x- and y-positioning are applied to the smoother and point layers. The aesthetic mapping of color is only applied to the point layer. The point layer also includes several fixed aesthetics.
</figcaption>
<div aria-describedby="fig-aes3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-aes3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="The global aesthetic mappings of x- and y-positioning are applied to the smoother and point layers. The aesthetic mapping of color is only applied to the point layer. The point layer also includes several fixed aesthetics.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="faceting-separate-plots-for-subgroups" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="faceting-separate-plots-for-subgroups"><span class="header-section-number">5.5</span> Faceting: Separate Plots for Subgroups</h2>
<p>Faceting creates a separate plot for different levels of a attribute. This is useful, for example, when you want a separate plot for different subgroups. To facet on a single attribute include the <code>facet_wrap()</code> layer. The wiggle, or tilde, (<code>~</code>) sets the attribute to facet on. In the following syntax, we create a separate plot for each region.</p>
<div class="cell" data-layout-align="center" data-labl="fig-facet">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Scatterplot of per person CO2 emissions versus income for 193 countries. This plot is shown for each of the four world regions.</figcaption>
<p><img src="01-05-visualizing-with-ggplot2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:70.0%" alt="Scatterplot of per person CO2 emissions versus income for 193 countries. This plot is shown for each of the four world regions."></p>
</figure>
</div>
</div>
</div>
<p>We can format the output of the facetted plots by setting the number of rows (<code>nrow=</code>) or columns (<code>ncol=</code>). For example, the following syntax outputs all four subplots in a single row.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-facet2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Scatterplot of per person CO2 emissions versus income for 193 countries. This plot is shown for each of the four world regions.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-facet2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.8: Scatterplot of per person CO2 emissions versus income for 193 countries. This plot is shown for each of the four world regions.
</figcaption>
<div aria-describedby="fig-facet2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-facet2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Scatterplot of per person CO2 emissions versus income for 193 countries. This plot is shown for each of the four world regions.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
<section id="facetting-on-multiple-variables" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="facetting-on-multiple-variables"><span class="header-section-number">5.5.1</span> Facetting on Multiple Variables</h3>
<p>To facet on multiple attributes, use <code>facet_grid()</code> rather than <code>facet_wrap()</code>. The <code>facet_grid()</code> layer also uses the wiggle or tilde, but in this function we will include an attribute before the tilde and a second attribute after the tilde. This defines the layout of the plot grid, so that the attribute that comes prior to the tilde will be facetted into separate rows, and the attribute that comes after the tilde will be facetted into different columns (i.e., <code>rows ~ columns</code>). The syntax below facets on both world region (rows) and CO2 change (columns).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Facet: regions in rows; </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(region <span class="sc">~</span> co2_change)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-facet3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Scatterplot of per person CO2 emissions versus income for 193 countries. This plot is shown for each of the four world regions and whether or not CO2 emissions increased or decreased since 2007.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-facet3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.9: Scatterplot of per person CO2 emissions versus income for 193 countries. This plot is shown for each of the four world regions and whether or not CO2 emissions increased or decreased since 2007.
</figcaption>
<div aria-describedby="fig-facet3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-facet3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Scatterplot of per person CO2 emissions versus income for 193 countries. This plot is shown for each of the four world regions and whether or not CO2 emissions increased or decreased since 2007.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="working-with-the-axes" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="working-with-the-axes"><span class="header-section-number">5.6</span> Working with the Axes</h2>
<p>Many of the functions and layers employed in <code>{ggplot2}</code> syntax is to fine-tune the plot and make it ready for publication. One place this happens is on the axes of the plot. Changing the labels, the limits, or even where breakpoints occur are all things you may want to adjust as you ready a plot for publication.</p>
<p><br></p>
<section id="changing-the-axis-label" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="changing-the-axis-label"><span class="header-section-number">5.6.1</span> Changing the Axis Label</h3>
<p>Two commonly used layers are <code>xlab()</code> and <code>ylab()</code>. These layers are used to change the label on the <em>x</em>- and <em>y</em>-axes, respectively. Here we change the axis label on both the <em>x</em>- and <em>y</em>-axes to give more information about the attributes being plotted.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the labels on the x- and y-axis</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Per-person income (in thousands of international dollars, fixed for 2017 prices)"</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Per-person CO2 emissions (in metric tonnes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-axis" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Using xlab() and ylab() to change the labels on the axes.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-axis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.10: Using xlab() and ylab() to change the labels on the axes.
</figcaption>
<div aria-describedby="fig-axis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-axis-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Using xlab() and ylab() to change the labels on the axes.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="changing-the-axis-limits" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="changing-the-axis-limits"><span class="header-section-number">5.6.2</span> Changing the Axis Limits</h3>
<p>Another set of commonly used layers are <code>xlim()</code> and <code>ylim()</code>. These layers are used to set the limits on the <em>x</em>-axis and <em>y</em>-axis, respectively. These functions take two values which set the limits on the particular axis. The first value provided is the minimum, and the second value given is the maximum. Here, for example, the <em>x</em>-limits in the plot will be 0 to 125, and the <em>y</em>-axis will be 0 to 50.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the limits on the x- and y-axis</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Per-person income (in thousands of international dollars, fixed for 2017 prices)"</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Per-person CO2 emissions (in metric tonnes)"</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">125</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-limits" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Using xlim() and ylim() to change the limits on the axes.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-limits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.11: Using xlim() and ylim() to change the limits on the axes.
</figcaption>
<div aria-describedby="fig-limits-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-limits-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Using xlim() and ylim() to change the limits on the axes.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="fine-tuning-axis-scales" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="fine-tuning-axis-scales"><span class="header-section-number">5.6.3</span> Fine-Tuning Axis Scales</h3>
<p>The <code>xlab()</code>, <code>ylab()</code>, <code>xlim()</code> and <code>ylim()</code> functions we used are shortcuts to using <em>scaling</em> layers. The use of scaling layers allows much more fine-tuning and control of the axis scales. There are four different scaling functions you can use depending on which axis (<em>x</em> or <em>y</em>) you want to control and whether the variable plotted along that axis is <em>continuous</em> or <em>discrete</em>. The four functions are:</p>
<ol type="1">
<li><code>scale_x_continuous()</code>,</li>
<li><code>scale_x_discrete()</code>,</li>
<li><code>scale_y_continuous()</code>, and</li>
<li><code>scale_y_discrete()</code>.</li>
</ol>
<p>For example, in our plot, to fine-tune the <em>x</em>-axis we could use <code>scale_x_continuous()</code> since <code>income</code> is a continuous variable and we want to fine-tune the <em>x</em>-axis.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fine-tune the x-axis</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Per-person income (in thousands of international dollars, fixed for 2017 prices)"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">125</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="dv">110</span>, <span class="dv">120</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Per-person CO2 emissions (in metric tonnes)"</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-all" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Scale on the x-axis set to have a label, as well as, specific limits, and break lines.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.12: Scale on the x-axis set to have a label, as well as, specific limits, and break lines.
</figcaption>
<div aria-describedby="fig-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-all-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Scale on the x-axis set to have a label, as well as, specific limits, and break lines.">
</div>
</figure>
</div>
</div>
</div>
<p>The <code>name=</code> option labels the scale—it replaces <code>xlab()</code>. The <code>limits=</code> argument takes a vector of the minimum and maximum values—it replaces <code>xlim()</code>. The <code>breaks=</code> option adds break lines on the axis. There are several other options including <code>labels=</code> for labeling the break lines, etc.</p>
<p><br></p>
</section>
<section id="customizing-the-color-and-fill" class="level3" data-number="5.6.4">
<h3 data-number="5.6.4" class="anchored" data-anchor-id="customizing-the-color-and-fill"><span class="header-section-number">5.6.4</span> Customizing the Color and Fill</h3>
<p>Scaling functions can also be used to fine-tune colors and fills. For these you need to specify the aesthetic, either color or fill, and also the palette you want to use. For example, <code>scale_fill_manual()</code> can be used to manually set the colors when the <code>fill=</code> aesthetic mapping is used, whereas <code>scale_color_manual()</code> can be used to manually set the colors when the <code>color=</code> aesthetic mapping is used.</p>
<p>In an earlier example, we used the <code>fill=</code> mapping to fill the points using the <code>region</code> attribute. Because of this we will use the layer <code>scale_fill_manual()</code> to change the fill colors. We use the <code>values=</code> argument to set the colors. Since the <code>region</code> attribute includes four values, we need to give the <code>values=</code> argument a vector of four different colors.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify fill colors using color names</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"skyblue"</span>, <span class="st">"plum"</span>, <span class="st">"orange"</span>, <span class="st">"chartreuse"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-color" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Color palette set manually using named color values.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-color-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.13: Color palette set manually using named color values.
</figcaption>
<div aria-describedby="fig-color-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-color-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Color palette set manually using named color values.">
</div>
</figure>
</div>
</div>
</div>
<p>Here, the alphabetic order of the values in the <code>region</code> variable correspond to the order of colors given in the <code>values=</code> argument of <code>scale_color_manual()</code>. In our examples:</p>
<ul>
<li>Africa –&gt; “skyblue”</li>
<li>Americas –&gt; “plum”</li>
<li>Asia –&gt; “orange”</li>
<li>Europe –&gt; “chartreuse”</li>
</ul>
<p>Instead of relying on alphabetical order, we can also assign a specific color to a specific region by using named arguments in the <code>scale_fill_manual()</code> layer. Here the names need to correspond to the different regions in the <code>region</code> variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify fill colors using color names and assign them to regions</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Africa"</span> <span class="ot">=</span> <span class="st">"chartreuse"</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Americas"</span> <span class="ot">=</span> <span class="st">"orange"</span>, </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Asia"</span> <span class="ot">=</span> <span class="st">"plum"</span>, </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Europe"</span> <span class="ot">=</span> <span class="st">"skyblue"</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-color2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Color palette set manually using named color values. Colors are assigned to specific regions by naming them in the `scale_fill_manula()` layer.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-color2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.14: Color palette set manually using named color values. Colors are assigned to specific regions by naming them in the <code>scale_fill_manula()</code> layer.
</figcaption>
<div aria-describedby="fig-color2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-color2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Color palette set manually using named color values. Colors are assigned to specific regions by naming them in the `scale_fill_manula()` layer.">
</div>
</figure>
</div>
</div>
</div>
<p>The color names used are built-in color names that R knows. There are 657 different named colors that you can use. To see them all, use the <code>colors()</code> function (with no arguments).</p>
<p><br></p>
<section id="specifying-colors-rgb-color-model" class="level4" data-number="5.6.4.1">
<h4 data-number="5.6.4.1" class="anchored" data-anchor-id="specifying-colors-rgb-color-model"><span class="header-section-number">5.6.4.1</span> Specifying Colors: RGB Color Model</h4>
<p>Colors can also be defined using an <a href="https://en.wikipedia.org/wiki/RGB_color_model">RGB color model</a>. This model uses a triplet of values to indicate the intensity of red (R), green (G), and blue (B) hues in the color. Each value in the triplet takes a value from 0 (none of that hue) to 255 (complete hue). For example, the color “skyblue” is equivalent to the RGB value of (135, 206, 235), where the triplet values correspond to:</p>
<ul>
<li>Red: 135</li>
<li>Green: 206</li>
<li>Blue: 235</li>
</ul>
<p>Using the RGB color model, we can obtain 16,777,216 different colors! To specify a color using the RGB color model, we use the <code>rgb()</code> function. This function takes the arguments <code>red=</code>, <code>green=</code> and <code>blue=</code>. We also need to indicate the maximum color value<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, in our case 255 using <code>maxColorValue=</code>. The syntax to re-create the colors from the previous plot using the RGB color model is shown below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify fill colors using RGB color model</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Africa"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="at">red =</span> <span class="dv">135</span>, <span class="at">green =</span> <span class="dv">206</span>, <span class="at">blue =</span> <span class="dv">235</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>), <span class="co">#skyblue</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Americas"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="at">red =</span> <span class="dv">221</span>, <span class="at">green =</span> <span class="dv">160</span>, <span class="at">blue =</span> <span class="dv">221</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>), <span class="co">#plum</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Asia"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="at">red =</span> <span class="dv">255</span>, <span class="at">green =</span> <span class="dv">165</span>, <span class="at">blue =</span> <span class="dv">0</span>,   <span class="at">maxColorValue =</span> <span class="dv">255</span>), <span class="co">#orange</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Europe"</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="at">red =</span> <span class="dv">127</span>, <span class="at">green =</span> <span class="dv">255</span>, <span class="at">blue =</span> <span class="dv">0</span>,   <span class="at">maxColorValue =</span> <span class="dv">255</span>) <span class="co">#chartreuse</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-color3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Color palette set manually using RGB triplets.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-color3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.15: Color palette set manually using RGB triplets.
</figcaption>
<div aria-describedby="fig-color3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-color3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Color palette set manually using RGB triplets.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="specifying-colors-hex" class="level4" data-number="5.6.4.2">
<h4 data-number="5.6.4.2" class="anchored" data-anchor-id="specifying-colors-hex"><span class="header-section-number">5.6.4.2</span> Specifying Colors: HEX</h4>
<p>Colors can also be defined using <a href="https://en.wikipedia.org/wiki/Hexadecimal">hexadecimal (hex)</a> notation. This notation takes the three RGB color model values (from 0–255) and converts each of those to a two-digit base-16 value. For example “skyblue”, which in the RGB color model was (135, 206, 235) in hex is:</p>
<ul>
<li>Red: 135 (RGB) –&gt; 87 (hex)</li>
<li>Green: 206 (RGB) –&gt; CE (hex)</li>
<li>Blue: 235 (RGB) –&gt; EB (hex)</li>
</ul>
<p>There are many websites that will convert between RGB values and hex, including Google. (Just type the following search string into Google: “convert 135, 206, 235 to hex”.) The hex notation for color is the six-digit value of the three concatenated two-digit color values. So skyblue is denoted:</p>
<ul>
<li>Skyblue: #87CEEB</li>
</ul>
<p>When we specify hex notation as a color in R, the six-digit color value is always preceeded by a hashtag (#). This is given as a character string instead of a color name. So to specify the colors in our plot using hex notation, the syntax is as follows.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify fill colors using hex notation</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Africa"</span> <span class="ot">=</span> <span class="st">"#87CEEB"</span>, </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Americas"</span> <span class="ot">=</span> <span class="st">"#DDA0DD"</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Asia"</span> <span class="ot">=</span> <span class="st">"#FFA500"</span>, </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Europe"</span> <span class="ot">=</span> <span class="st">"#7FFF00"</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-color4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Color palette set manually using hex notation.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-color4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.16: Color palette set manually using hex notation.
</figcaption>
<div aria-describedby="fig-color4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-color4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Color palette set manually using hex notation.">
</div>
</figure>
</div>
</div>
</div>
<div class="fyi">
<p><strong>FYI</strong></p>
<p>Using lower-case letters in the hex notation would also work. Just remember to always include a hashtag when specifying hex.</p>
</div>
<p><br></p>
</section>
</section>
</section>
<section id="selecting-a-color-palette" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="selecting-a-color-palette"><span class="header-section-number">5.7</span> Selecting a Color Palette</h2>
<p>Selecting a color palette can be challenging. It should be aesthetically pleasing, but needs to convey the differences and nuances in the data that you are using color to display. Here are a few resources for thinking about color palettes:</p>
<ul>
<li><a href="https://betterfigures.org/2015/06/23/picking-a-colour-scale-for-scientific-graphics/">Picking a Colour Scale for Scientific Graphics</a></li>
<li><a href="http://jfly.iam.u-tokyo.ac.jp/color/">Color Universal Design (CUD): How to Make Figures and Presentations that are Friendly to Colorblind People</a></li>
<li><a href="https://github.com/EmilHvitfeldt/r-color-palettes">Color Palettes in R</a></li>
</ul>
<p>One good set of color palettes are the <a href="https://colorbrewer2.org/">Brewer palettes</a>. These palettes were chosen by Cynthia Brewer, a cartographer and artist, to be both colorblind friendly and aesthetically pleasing. Moreover, the palettes were designed to help humans make sense of the visualized data based on how we perceive the colors that are displayed. She has palettes for three different types of data</p>
<ul>
<li><strong>Qualitative/Categorical:</strong> Colors do not have a perceived order</li>
<li><strong>Sequential:</strong> Colors have a perceived order and perceived difference between successive colors is uniform</li>
<li><strong>Diverging:</strong> Two back-to-back sequential palettes starting from a common color (e.g., for Likert scale data)</li>
</ul>
<p>Martin Krzywinski has written a <a href="http://mkweb.bcgsc.ca/brewer/">very readable introduction</a> to the Brewer color palettes.</p>
<p><br></p>
<section id="accessible-color-palettes" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="accessible-color-palettes"><span class="header-section-number">5.7.1</span> Accessible Color Palettes</h3>
<p>You will also want to think about accessibility in your choice of color palette. Roughly 8% of males and 0.5% of females have some form of color vision deficiency which will affect how they see and interpret the plot. One good palette for colorblindness is the Okabe Ito palette.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-brewer" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Okabe Ito colorblind-friendly palette. Colors include #000000, #e69f00, #56b4e9, #009e73, #f0e442, #0072b2, #d55e00, and #cc79a7.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-brewer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.17: Okabe Ito colorblind-friendly palette.
</figcaption>
<div aria-describedby="fig-brewer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/01-05-okabe-ito-palette.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Okabe Ito colorblind-friendly palette. Colors include #000000, #e69f00, #56b4e9, #009e73, #f0e442, #0072b2, #d55e00, and #cc79a7.">
</div>
</figure>
</div>
</div>
</div>
<p>Also, the new Federal accessibility law requires certain levels of color contrast. Although this applies mainly to text color, thinking about color contrasts is good practice. You can check the contrast of two colors at <a href="https://contrast-ratio.org/" class="uri">https://contrast-ratio.org/</a>.</p>
<p><br></p>
</section>
<section id="organizational-color-palettes" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="organizational-color-palettes"><span class="header-section-number">5.7.2</span> Organizational Color Palettes</h3>
<p>If you are creating visualizations for a particular organization, there may be a palette of official colors associated with their brand. For example, the University of Minnesota’s two official primary colors in hex notation (for electronic display) are:</p>
<ul>
<li><code>#ffcc33</code> (gold)</li>
<li><code>#7a0019</code> (maroon)</li>
</ul>
<p>You can see more on the <a href="https://university-relations.umn.edu/resources/colors-and-type">University Relations Colors and Type</a> page. They also have a palette of complementary colors available.</p>
<p><br></p>
</section>
<section id="packages-with-color-palettes" class="level3" data-number="5.7.3">
<h3 data-number="5.7.3" class="anchored" data-anchor-id="packages-with-color-palettes"><span class="header-section-number">5.7.3</span> Packages with Color Palettes</h3>
<p>There are several packages that include functions with built-in color palettes. Some of my favorite extension packages include:</p>
<ul>
<li><code>{ggthemes}</code> includes palettes used by FiveThirtyEight and Tableau [see <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/">here</a>];</li>
<li><code>{wesanderson}</code> includes palettes based on Wes Anderson movies [see <a href="https://github.com/karthik/wesanderson">here</a>]; and</li>
<li><code>{nationalparkcolors}</code> includes palettes based on National Park posters and images [see <a href="https://github.com/katiejolly/nationalparkcolors">here</a>; this needs to be installed from GitHub].</li>
</ul>
<p>Emil Hvitfeldt has also put together a package called <code>{paletteer}</code>, that includes a comprehensive collection of color palettes in R that can be called using a common interface [see <a href="https://github.com/EmilHvitfeldt/r-color-palettes">here</a>].</p>
<p><br></p>
</section>
</section>
<section id="customizing-the-legendguide" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="customizing-the-legendguide"><span class="header-section-number">5.8</span> Customizing the Legend/Guide</h2>
<p>Scaling functions can also be used to change the name and labels in the legend or guide. When we used the color scales, the guide included both the name of the attribute being plotted, and each value of the attribute along with its corresponding fill color. To change the , We can include the argument <code>name=</code> to edit the text of the attribute name in the guide. We can also use <code>labels=</code> to edit the text for each of the attribute vaslues. For example, below we change the text of the attribute in the guide to read “World Region” and the text of “Americas” to instead read “The Americas”. Note that because there are four attribute values, the <code>labels=</code> argument needs to have a vector with four values; we can’t only include the text we want to change.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify Brewer color palette (qualitative, Set 1)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"World Region"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Africa"</span> <span class="ot">=</span> <span class="st">"#87CEEB"</span>, <span class="st">"Americas"</span> <span class="ot">=</span> <span class="st">"#DDA0DD"</span>, <span class="st">"Asia"</span> <span class="ot">=</span> <span class="st">"#FFA500"</span>, <span class="st">"Europe"</span> <span class="ot">=</span><span class="st">"#7FFF00"</span>),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Africa"</span>, <span class="st">"The Americas"</span>, <span class="st">"Asia"</span>, <span class="st">"Europe"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-legend" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Customizing the legend with the `labels=` argument in `scale_color_manual()`.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-legend-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.18: Customizing the legend with the <code>labels=</code> argument in <code>scale_color_manual()</code>.
</figcaption>
<div aria-describedby="fig-legend-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-legend-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Customizing the legend with the `labels=` argument in `scale_color_manual()`.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="themes-changing-the-look-of-your-plot" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="themes-changing-the-look-of-your-plot"><span class="header-section-number">5.9</span> Themes: Changing the Look of Your Plot</h2>
<p>There are several “built-in” themes that you can use to change the look of your plot: <code>theme_grey()</code>, <code>theme_minimal()</code>, <code>theme_linedraw()</code>, <code>theme_light()</code>, <code>theme_dark()</code>, <code>theme_minimal()</code>, <code>theme_classic()</code>, <code>theme_void()</code>, and <code>theme_test()</code>. The default theme is <code>theme_grey()</code>. Here we use the layer <code>theme_minimal()</code> to modify the look of our plot. This theme uses a minimal black-and-white background (rather than grey).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the `theme_minimal()` layer to update the look of the plot</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"World Region"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Africa"</span> <span class="ot">=</span> <span class="st">"#87CEEB"</span>, <span class="st">"Americas"</span> <span class="ot">=</span> <span class="st">"#DDA0DD"</span>, <span class="st">"Asia"</span> <span class="ot">=</span> <span class="st">"#FFA500"</span>, <span class="st">"Europe"</span> <span class="ot">=</span><span class="st">"#7FFF00"</span>),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Africa"</span>, <span class="st">"The Americas"</span>, <span class="st">"Asia"</span>, <span class="st">"Europe"</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-theme" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Using the `theme_minimal()` layer to update the look of the plot.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.19: Using the <code>theme_minimal()</code> layer to update the look of the plot.
</figcaption>
<div aria-describedby="fig-theme-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-theme-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Using the `theme_minimal()` layer to update the look of the plot.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
<section id="the-ggthemes-package" class="level3" data-number="5.9.1">
<h3 data-number="5.9.1" class="anchored" data-anchor-id="the-ggthemes-package"><span class="header-section-number">5.9.1</span> The ggthemes Package</h3>
<p>The <code>{ggthemes}</code> package includes 20 additional themes that you can use to style your plot (see <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/">here</a> to view the different themes available). Here I use a theme similar to that from plots that appear in the Wall Street Journal.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the `theme_wsj()` layer to update the look of the plot</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"World Region"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#87CEEB"</span>, <span class="st">"#DDA0DD"</span>, <span class="st">"#FFA500"</span>, <span class="st">"#7FFF00"</span>),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Africa"</span>, <span class="st">"The Americas"</span>, <span class="st">"Asia"</span>, <span class="st">"Europe"</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_wsj</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-wsj" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Using the `theme_wsj()` layer from the `{ggthemes}` package to update the look of the plot to look like plots in the Wall Street Journal.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-wsj-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.20: Using the <code>theme_wsj()</code> layer from the <code>{ggthemes}</code> package to update the look of the plot to look like plots in the Wall Street Journal.
</figcaption>
<div aria-describedby="fig-wsj-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-wsj-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Using the `theme_wsj()` layer from the `{ggthemes}` package to update the look of the plot to look like plots in the Wall Street Journal.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="customizing-a-theme" class="level3" data-number="5.9.2">
<h3 data-number="5.9.2" class="anchored" data-anchor-id="customizing-a-theme"><span class="header-section-number">5.9.2</span> Customizing a Theme</h3>
<p>The <code>theme()</code> layer can be used to change every element in the plot (e.g., grid lines, font, color, etc.). See <a href="http://docs.ggplot2.org/current/theme.html">here</a> for more detail. In the syntax below, we call <code>theme_minimal()</code> to get the minimal black-and-white them from before, and the use arguments in the <code>theme()</code> layer to change the font face and color on the axes labels.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the `theme_minimal()` layer to update the look of the plot</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"World Region"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#87CEEB"</span>, <span class="st">"#DDA0DD"</span>, <span class="st">"#FFA500"</span>, <span class="st">"#7FFF00"</span>),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Africa"</span>, <span class="st">"The Americas"</span>, <span class="st">"Asia"</span>, <span class="st">"Europe"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"blue"</span>),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-theme-custom" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="You can customize almost any part of the theme using the `theme()` layer. In this plot we changed the font color on the x-axis label and increased the font size of all the text elements in the plot.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-theme-custom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.21: You can customize almost any part of the theme using the <code>theme()</code> layer. In this plot we changed the font color on the x-axis label and increased the font size of all the text elements in the plot.
</figcaption>
<div aria-describedby="fig-theme-custom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-theme-custom-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="You can customize almost any part of the theme using the `theme()` layer. In this plot we changed the font color on the x-axis label and increased the font size of all the text elements in the plot.">
</div>
</figure>
</div>
</div>
</div>
<p>The <code>theme()</code> function can also be used to create your own <code>{ggplot2}</code> theme. This is useful if you always want your plots to look a certain way (e.g., to fit an organizations style guide) or are always using the same modifications to the theme in your plots. Below, I create a theme called <code>theme_andy()</code> that</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create theme_andy()</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>theme_andy <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add border</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"#7a0019"</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linetype =</span> <span class="dv">1</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify grid</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#7a0019"</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">0.25</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#ffb71e"</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#7a0019"</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">0.25</span>),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#ffb71e"</span>),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># modify text, axis and color</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"#5b0013"</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"#5b0013"</span>, <span class="at">family =</span> <span class="st">"Times New Roman"</span>),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"#5b0013"</span>),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># legend at the bottom</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Use theme_andy() to theme the plot</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"World Region"</span>,</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#87CEEB"</span>, <span class="st">"#DDA0DD"</span>, <span class="st">"#FFA500"</span>, <span class="st">"#7FFF00"</span>),</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Africa"</span>, <span class="st">"The Americas"</span>, <span class="st">"Asia"</span>, <span class="st">"Europe"</span>)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_andy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-andy" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="You can also create your own theme to use with any plot.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-andy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.22: You can also create your own theme to use with any plot.
</figcaption>
<div aria-describedby="fig-andy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-andy-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="You can also create your own theme to use with any plot.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="ggplot2-extension-packages" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="ggplot2-extension-packages"><span class="header-section-number">5.10</span> <code>{ggplot2}</code> Extension Packages</h2>
<p>There are several packages that extend the functionality of <code>{ggplot2}</code>. Many of these packages are listed at the <a href="https://exts.ggplot2.tidyverse.org/">ggplot2 Extensions</a> page.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-extensions" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="Extensions are available at the ggplot2 extensions website.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-extensions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.23: Extensions are available at the ggplot2 extensions website.
</figcaption>
<div aria-describedby="fig-extensions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/01-05-ggplot-extensions.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Extensions are available at the ggplot2 extensions website.">
</div>
</figure>
</div>
</div>
</div>
<p>One useful extension package is the <code>{scales}</code> package. The functions and layers in this package are useful for transforming and labeling scales that are used to create your plot. For example, one of the functions in the <code>{scales}</code> package. <code>label_number()</code>, can be used to add a character prior to, or after all the numerical values labelled on an axis (very useful if the attribute being plotted is dollars). There is a nice web tutorial on using the <code>{scales}</code> package <a href="https://bookdown.org/Maxine/ggplot2-maps/posts/2019-11-27-using-scales-package-to-modify-ggplot2-scale/">here</a>.</p>
<p>Here we add</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the `{scales}` package to add $ in front of labels and k at the end on the x-axis</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> co2)) <span class="sc">+</span>  </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"World Region"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#87CEEB"</span>, <span class="st">"#DDA0DD"</span>, <span class="st">"#FFA500"</span>, <span class="st">"#7FFF00"</span>),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Africa"</span>, <span class="st">"The Americas"</span>, <span class="st">"Asia"</span>, <span class="st">"Europe"</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Income (in international dollars, fixed for 2017 prices)"</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">prefix =</span> <span class="st">"$"</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scales" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" alt="The `{scales}` package helps format labels on the axes. Here we have used it to add a dollar sign in front of labels on the x-axis.">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-scales-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.24: The <code>{scales}</code> package helps format labels on the axes. Here we have used it to add a dollar sign in front of labels on the x-axis.
</figcaption>
<div aria-describedby="fig-scales-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01-05-visualizing-with-ggplot2_files/figure-html/fig-scales-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="The `{scales}` package helps format labels on the axes. Here we have used it to add a dollar sign in front of labels on the x-axis.">
</div>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="captions-and-figure-numbering" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="captions-and-figure-numbering"><span class="header-section-number">5.11</span> Captions and Figure Numbering</h2>
<div class="protip">
<p><strong>PROTIP</strong></p>
<p>It is easier to use a word-processor (e.g., MS Word) to add the figure title and caption than to try and get it formatted correctly using R. This is especially true when trying to mimic the APA format.</p>
</div>
<p>Here is one workflow for saving plots, importing the saved plot into your word-processing application, and adding a figure number and caption.</p>
<ul>
<li>Create your plot in R.</li>
<li>Export it (Click the <code>Export</code> button above the plot in RStudio.</li>
<li>Select <code>Save as Image...</code></li>
<li>Click `Directory to indicate where you want to save the image</li>
<li>Give the plot a name in the <code>File name</code> box</li>
<li>Change the height and width values until you have a good aspect ratio for the plot. You can preview the image to see that it looks good.</li>
<li>Click <code>Save</code></li>
<li>In Word or Google Docs, import the image from where you saved it.</li>
<li>Resize the image to take up less space if you can. (It needs to be readable, but not too big.)</li>
<li>Add the figure number and caption using your word-processing document.</li>
</ul>
<p><br></p>
<!-- ## Using Piping with `{ggplot2}` -->
<!-- Since output from the piping operator produces a data frame, we can pipe the data into the `ggplot()` global layer rather than using the argument `data=`. For example: -->
<!-- ```{r} -->
<!-- #| eval: false -->
<!-- # Use piping to indicate the data -->
<!-- gapminder |> -->
<!--   ggplot(aes(x = income, y = co2)) +   -->
<!--     geom_smooth() + -->
<!--     geom_point()  -->
<!-- ``` -->
<!-- This is useful if you are wrangling data and want to see a plot. Here for example we filter to obtain the African countries and create the plot using only those countries. Note that since we only have observations from one region, we can now change the `fill=` to a fixed aesthetic. -->
<!-- ```{r} -->
<!-- #| fig-width: 8 -->
<!-- #| fig-height: 6 -->
<!-- #| out-width: '60%' -->
<!-- #| fig-cap: Using `{dplyr}` functions and piping to plot athe African countries. -->
<!-- gapminder |> -->
<!--   filter(region == "Africa") |> -->
<!--   ggplot(aes(x = income, y = co2)) +   -->
<!--     geom_smooth() + -->
<!--     geom_point(shape = 21, size = 4, fill = "#87CEEB") + -->
<!--     theme_minimal() -->
<!-- ``` -->
<!-- <br /> -->
</section>
<section id="practice-practice-practice" class="level2" data-number="5.12">
<h2 data-number="5.12" class="anchored" data-anchor-id="practice-practice-practice"><span class="header-section-number">5.12</span> Practice, Practice, Practice</h2>
<p>The key to becoming a <code>{ggplot2}</code> ninja is to practice by creating visualizations. They don’t have to be fancy! Even by creating simple visualizations, you will hone your skills. As you become more confident try changing the color, or the labels, or really anything.</p>
<p>If you are unsure where to start, one practice method I have found helpful is to try and re-create a plot that someone else has already created. There are many datasets available online that people have created plots for. One source of these is the <a href="https://github.com/rfordatascience/tidytuesday">Tidy Tuesday Repository</a>.</p>
<p>There are also several resources to help you get started and continue your <code>gg_journey</code>! Here are a few I have found helpful:</p>
<ul>
<li><strong>Data visualization with ggplot2 cheatsheet :</strong> A one-page (front and back) cheatsheet of ggplot2 syntax with pictures https://www.rstudio.com/resources/cheatsheets/</li>
<li><strong>Cookbook for R:</strong> Web-based version of Winston Chang’s R Graphics Cookbook http://www.cookbook-r.com/Graphs/ (The UMN library has electronic access to the actual book. Just search for “R Graphics Cookbook” and log-in with your x500.)</li>
<li><strong>Data Visualization: A Practical Introduction:</strong> Online book about data viz using ggplot2 https://socviz.co/</li>
</ul>
<p>Happy Plotting!!! 📈 🎉</p>
<p><br></p>
</section>
<section id="additional-resources" class="level2" data-number="5.13">
<h2 data-number="5.13" class="anchored" data-anchor-id="additional-resources"><span class="header-section-number">5.13</span> Additional Resources</h2>
<p>Here are some additional resources for learning <code>{ggplot2}</code>.</p>
<ul>
<li><a href="https://www.rstudio.com/resources/cheatsheets/">Data Visualization with ggplot2 Cheatsheet</a>: A printable cheatsheet for using <code>{ggplot2}</code>.</li>
<li><a href="http://www.cookbook-r.com/Graphs/">Cookbook for R: Graphs</a>: This book is full of how-to recipes, each of which solves a specific problem using <code>{ggplot2}</code>. The recipe includes a quick introduction to the solution followed by a discussion that aims to unpack the solution and give you some insight into how it works.</li>
<li><a href="https://www.youtube.com/watch?v=HeqHMM4ziXA">Plotting with ggplot: Part 1</a> [video]</li>
<li><a href="https://www.youtube.com/watch?v=n8kYa9vu1l8">Plotting with ggplot: Part 2</a> [video]</li>
</ul>
<p><br></p>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-wilkinson:2005" class="csl-entry" role="listitem">
Wilkinson, L. (2005). <em>The grammar of graphics</em> (2nd ed.). Springer.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Computer scientists often use a 0–1 scale of intensity rather than a 0–255. In that case, our color of “skyblue” would have an RGB triplet of (0.5294118 0.8078431 0.9215686). Here the original RGB triplet values are divided by 255.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>